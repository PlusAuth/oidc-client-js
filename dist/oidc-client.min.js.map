{"version":3,"file":"oidc-client.min.js","sources":["../src/constants/events.ts","../src/errors.ts","../src/helpers/state_manager/state_store.ts","../src/helpers/state_manager/local_storage.ts","../src/helpers/state_manager/in_memory.ts","../src/helpers/event_emitter.ts","../src/helpers/timer.ts","../src/utils/iframe.ts","../node_modules/base64-js/index.js","../src/client.ts","../node_modules/unfetch/dist/unfetch.module.js","../node_modules/isomorphic-unfetch/browser.js","../src/utils/url.ts","../src/utils/request.ts","../src/utils/jose.ts","../src/utils/oidc.ts","../src/utils/popup.ts","../src/utils/tab_utils.ts","../src/utils/check_session_iframe.ts","../src/index.ts"],"sourcesContent":["/* eslint-disable @typescript-eslint/indent */\nexport const Events = {\n  USER_LOGOUT:          'user_logout',\n  USER_LOGIN:           'user_login',\n  SILENT_RENEW_SUCCESS: 'silent_renew_success',\n  SILENT_RENEW_ERROR:   'silent_renew_error',\n  SESSION_CHANGE:       'session_change'\n} as const\n\nexport type EventTypes = 'user_logout' | 'user_login' | 'silent_renew_success' |\n                          'silent_renew_error' | 'session_change' | 'session_error'\n","export class OIDCClientError extends Error {\n  error: string;\n\n  error_description?: string;\n\n  public constructor( error: string, error_description?: string ) {\n    super( `${ error }${ error_description && ` - ${ error_description }` || '' }` );\n    this.name = 'OIDCClientError'\n    this.error = error\n    this.error_description = error_description\n  }\n}\n\nexport class AuthenticationError extends OIDCClientError {\n  state?: string;\n\n  error_uri?: string;\n\n  constructor( error: string, error_description?: string, state?: string, error_uri?: string ) {\n    super( error, error_description );\n    this.name = 'AuthenticationError'\n    this.state = state;\n    this.error_uri = error_uri;\n  }\n}\n\nexport class InvalidJWTError extends OIDCClientError {\n  constructor( details: string ) {\n    super( details );\n    this.name = 'InvalidJWTError'\n    this.error_description = details\n  }\n}\nexport class InvalidIdTokenError extends InvalidJWTError {\n  constructor( details: string ) {\n    super( details );\n    this.name = 'InvalidIdTokenError'\n  }\n}\n\nexport class InteractionCancelled extends OIDCClientError {\n  constructor( details: string ) {\n    super( details );\n    this.name = 'InteractionCancelled'\n  }\n}\n","export interface StateStore {\n  init?(): Promise<StateStore>\n}\nexport abstract class StateStore {\n  prefix: string;\n\n  constructor( prefix = '' ) {\n    this.prefix = prefix\n  }\n\n  public abstract get( key: string ): Promise<Record<string, any> | null>;\n\n  public abstract set( key: string, value: Record<string, any> ): Promise<void>;\n\n  public abstract del( key: string ): Promise<void>;\n\n  public abstract clear( maxAge?: number ): Promise<void>;\n}\n","import { StateStore } from './state_store';\n\nexport class LocalStorageStateStore extends StateStore {\n  constructor( prefix = 'pa_oidc.' ) {\n    super( prefix )\n  }\n\n  get( key: string ) {\n    return new Promise<Record<string, any> | null>( ( resolve ) => {\n      const value = window.localStorage.getItem( this.prefix + key );\n      if ( value ) {\n        resolve( JSON.parse( value ) );\n      } else {\n        resolve( null );\n      }\n    } );\n  }\n\n  set( key: string, value: Record<string, any> ) {\n    return new Promise<void>( ( resolve ) => {\n      window.localStorage.setItem( this.prefix + key, JSON.stringify( value ) );\n      resolve();\n    } );\n  }\n\n  del( key: string ) {\n    return new Promise<void>( ( resolve ) => {\n      window.localStorage.removeItem( this.prefix + key );\n      resolve();\n    } );\n  }\n\n  clear( before?: number ): Promise<void> {\n    return new Promise<void>( ( resolve ) => {\n      let i;\n      const storedKeys: string[] = [];\n      for ( i = 0; i < window.localStorage.length; i++ ) {\n        const key = window.localStorage.key( i )\n        // items only created by oidc client\n        if ( key?.substring( 0, this.prefix.length ) == this.prefix ) {\n          storedKeys.push( key );\n        }\n      }\n      for ( i = 0; i < storedKeys.length; i++ ) {\n        if ( before ) {\n          try {\n            const storedItem = JSON.parse( window.localStorage.getItem( storedKeys[i] )! )\n            if ( storedItem.created_at < before ) {\n              window.localStorage.removeItem( storedKeys[i] )\n            }\n          } catch ( e ) {\n          }\n        } else {\n          window.localStorage.removeItem( storedKeys[i] )\n        }\n      }\n      resolve();\n    } );\n  }\n}\n","import { StateStore } from './state_store';\n\nexport class InMemoryStateStore extends StateStore {\n  map = new Map()\n\n  clear( before?: number ) {\n    if ( before ){\n      this.map.forEach( ( val, ind ) => {\n        if ( val.created_at < before ){\n          this.map.delete( ind )\n        }\n      } )\n      return Promise.resolve()\n    } else {\n      return Promise.resolve( this.map.clear() );\n    }\n  }\n\n  del( key: string ) {\n    this.map.delete( key )\n    return Promise.resolve( );\n  }\n\n  get( key: string ) {\n    return Promise.resolve( this.map.get( key ) || null );\n  }\n\n  set( key: string, value: any ) {\n    this.map.set( key, value )\n    return Promise.resolve();\n  }\n}\n","export type Listener = ( ...args: any ) => void\n\nexport class EventEmitter<T extends string>{\n  callbacks: Record<string, any[] >;\n\n  constructor(){\n    this.callbacks = {}\n  }\n\n  once( event: T, fn: ( ...args: any[] ) => void ){\n    function on( this: EventEmitter<any>, ...onArgs: any[] ) {\n      this.off( event, on );\n      fn.apply( this, onArgs );\n    }\n    on.fn = fn\n    this.on( event, on );\n    return this;\n  }\n\n  on( event: T, cb: ( ...args: any[] ) => void ){\n    if ( !this.callbacks[`$${ event }`] ) this.callbacks[`$${ event }`] = [];\n    this.callbacks[`$${ event }`].push( cb )\n    return this\n  }\n\n  off( event?: T, fn?: ( ...args: any[] ) => void ){\n    if ( !event ) {\n      this.callbacks = {};\n      return this;\n    }\n\n    // specific event\n    const callbacks = this.callbacks[`$${ event }`];\n    if ( !callbacks ) return this;\n\n    // remove all handlers\n    if ( !fn ) {\n      delete this.callbacks[`$${ event }`];\n      return this;\n    }\n\n    for ( let i = 0; i < callbacks.length; i++ ) {\n      const cb = callbacks[i];\n      if ( cb === fn || cb.fn === fn ) {\n        callbacks.splice( i, 1 );\n        break;\n      }\n    }\n\n    // Remove event specific arrays for event types that no\n    // one is subscribed for to avoid memory leak.\n    if ( callbacks.length === 0 ) {\n      delete this.callbacks[`$${ event }`];\n    }\n\n    return this;\n  }\n\n  emit( event: T, ...args: any[] ){\n    let cbs = this.callbacks[`$${ event }`]\n    if ( cbs ) {\n      cbs = cbs.slice( 0 );\n      for ( let i = 0, len = cbs.length; i < len; ++i ) {\n        cbs[i].apply( this, args );\n      }\n    }\n    return this\n  }\n}\n","export class Timer {\n  private now: () => number;\n\n  private _timerHandle: any;\n\n  private _expiration!: number;\n\n  constructor( currentTimeInMillisFunc = () => Date.now() ) {\n    this.now = currentTimeInMillisFunc\n  }\n\n  start( duration: number, callback: () => void ){\n    if ( duration <= 0 ) {\n      duration = 1;\n    }\n    const expiration = this.now() / 1000 + duration;\n    if ( this._expiration === expiration && this._timerHandle ) {\n      return;\n    }\n\n    this.stop();\n\n    this._expiration = expiration;\n\n    // prevent device sleep and delayed timers\n    let timerDuration = 5;\n    if ( duration < timerDuration ) {\n      timerDuration = duration;\n    }\n    this._timerHandle = setInterval( ()=>{\n      if ( this._expiration <= this.now() / 1000 ) {\n        this.stop();\n        callback()\n      }\n    }, timerDuration * 1000 );\n  }\n\n  stop() {\n    if ( this._timerHandle ) {\n      clearInterval( this._timerHandle );\n      this._timerHandle = null;\n    }\n  }\n}\n","import { AuthenticationError, OIDCClientError } from '../errors';\nimport type { IFrameOptions } from '../interfaces';\n\nexport function createHiddenFrame() {\n  const iframe = window.document.createElement( 'iframe' );\n  iframe.style.width = '0';\n  iframe.style.height = '0';\n  iframe.style.position = 'absolute';\n  iframe.style.visibility = 'hidden';\n  iframe.style.display = 'none';\n\n  iframe.title = '__pa_helper__hidden'\n  iframe.ariaHidden = 'true'\n\n  return iframe\n}\n\nexport function runIframe(\n  url: string,\n  options: IFrameOptions\n) {\n  return new Promise<any>( ( resolve, reject ) => {\n    let onLoadTimeoutId: any = null;\n    const iframe = createHiddenFrame()\n\n    const timeoutSetTimeoutId = setTimeout( () => {\n      reject( new OIDCClientError( 'Timed out' ) );\n      removeIframe();\n    }, ( options.timeout || 10 ) * 1000 );\n\n    const iframeEventHandler =  ( e: MessageEvent ) => {\n      if ( e.origin != options.eventOrigin ) return;\n      if ( !e.data || e.data.type !== 'authorization_response' ) return;\n      const eventSource = e.source;\n      if ( eventSource ) {\n        ( <any>eventSource ).close();\n      }\n\n      const resp = e.data.response || e.data\n      resp.error\n        ? reject( new AuthenticationError( resp.error, resp.error_description, resp.state, resp.error_uri ) )\n        : resolve( e.data );\n      clearTimeout( timeoutSetTimeoutId );\n      removeIframe();\n    };\n\n    const removeIframe = () => {\n      if ( onLoadTimeoutId != null ){\n        clearTimeout( onLoadTimeoutId )\n      }\n      if ( window.document.body.contains( iframe ) ) {\n        window.document.body.removeChild( iframe );\n      }\n      window.removeEventListener( 'message', iframeEventHandler, false );\n    };\n\n    const onLoadTimeout = () => setTimeout( ()=>{\n      reject( new OIDCClientError( 'Could not complete silent authentication', url ) )\n      removeIframe();\n    }, 300 )\n\n\n\n    window.addEventListener( 'message', iframeEventHandler, false );\n    window.document.body.appendChild( iframe );\n    iframe.setAttribute( 'src', url );\n\n    /**\n     * In case of wrong client id, wrong redirect_uri, in short when redirect did not happen\n     * we assume flow failed.\n     */\n    iframe.onload = function () {\n      onLoadTimeoutId = onLoadTimeout()\n    }\n  } );\n}\n","'use strict'\n\nexports.byteLength = byteLength\nexports.toByteArray = toByteArray\nexports.fromByteArray = fromByteArray\n\nvar lookup = []\nvar revLookup = []\nvar Arr = typeof Uint8Array !== 'undefined' ? Uint8Array : Array\n\nvar code = 'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/'\nfor (var i = 0, len = code.length; i < len; ++i) {\n  lookup[i] = code[i]\n  revLookup[code.charCodeAt(i)] = i\n}\n\n// Support decoding URL-safe base64 strings, as Node.js does.\n// See: https://en.wikipedia.org/wiki/Base64#URL_applications\nrevLookup['-'.charCodeAt(0)] = 62\nrevLookup['_'.charCodeAt(0)] = 63\n\nfunction getLens (b64) {\n  var len = b64.length\n\n  if (len % 4 > 0) {\n    throw new Error('Invalid string. Length must be a multiple of 4')\n  }\n\n  // Trim off extra bytes after placeholder bytes are found\n  // See: https://github.com/beatgammit/base64-js/issues/42\n  var validLen = b64.indexOf('=')\n  if (validLen === -1) validLen = len\n\n  var placeHoldersLen = validLen === len\n    ? 0\n    : 4 - (validLen % 4)\n\n  return [validLen, placeHoldersLen]\n}\n\n// base64 is 4/3 + up to two characters of the original data\nfunction byteLength (b64) {\n  var lens = getLens(b64)\n  var validLen = lens[0]\n  var placeHoldersLen = lens[1]\n  return ((validLen + placeHoldersLen) * 3 / 4) - placeHoldersLen\n}\n\nfunction _byteLength (b64, validLen, placeHoldersLen) {\n  return ((validLen + placeHoldersLen) * 3 / 4) - placeHoldersLen\n}\n\nfunction toByteArray (b64) {\n  var tmp\n  var lens = getLens(b64)\n  var validLen = lens[0]\n  var placeHoldersLen = lens[1]\n\n  var arr = new Arr(_byteLength(b64, validLen, placeHoldersLen))\n\n  var curByte = 0\n\n  // if there are placeholders, only get up to the last complete 4 chars\n  var len = placeHoldersLen > 0\n    ? validLen - 4\n    : validLen\n\n  var i\n  for (i = 0; i < len; i += 4) {\n    tmp =\n      (revLookup[b64.charCodeAt(i)] << 18) |\n      (revLookup[b64.charCodeAt(i + 1)] << 12) |\n      (revLookup[b64.charCodeAt(i + 2)] << 6) |\n      revLookup[b64.charCodeAt(i + 3)]\n    arr[curByte++] = (tmp >> 16) & 0xFF\n    arr[curByte++] = (tmp >> 8) & 0xFF\n    arr[curByte++] = tmp & 0xFF\n  }\n\n  if (placeHoldersLen === 2) {\n    tmp =\n      (revLookup[b64.charCodeAt(i)] << 2) |\n      (revLookup[b64.charCodeAt(i + 1)] >> 4)\n    arr[curByte++] = tmp & 0xFF\n  }\n\n  if (placeHoldersLen === 1) {\n    tmp =\n      (revLookup[b64.charCodeAt(i)] << 10) |\n      (revLookup[b64.charCodeAt(i + 1)] << 4) |\n      (revLookup[b64.charCodeAt(i + 2)] >> 2)\n    arr[curByte++] = (tmp >> 8) & 0xFF\n    arr[curByte++] = tmp & 0xFF\n  }\n\n  return arr\n}\n\nfunction tripletToBase64 (num) {\n  return lookup[num >> 18 & 0x3F] +\n    lookup[num >> 12 & 0x3F] +\n    lookup[num >> 6 & 0x3F] +\n    lookup[num & 0x3F]\n}\n\nfunction encodeChunk (uint8, start, end) {\n  var tmp\n  var output = []\n  for (var i = start; i < end; i += 3) {\n    tmp =\n      ((uint8[i] << 16) & 0xFF0000) +\n      ((uint8[i + 1] << 8) & 0xFF00) +\n      (uint8[i + 2] & 0xFF)\n    output.push(tripletToBase64(tmp))\n  }\n  return output.join('')\n}\n\nfunction fromByteArray (uint8) {\n  var tmp\n  var len = uint8.length\n  var extraBytes = len % 3 // if we have 1 byte left, pad 2 bytes\n  var parts = []\n  var maxChunkLength = 16383 // must be multiple of 3\n\n  // go through the array every three bytes, we'll deal with trailing stuff later\n  for (var i = 0, len2 = len - extraBytes; i < len2; i += maxChunkLength) {\n    parts.push(encodeChunk(uint8, i, (i + maxChunkLength) > len2 ? len2 : (i + maxChunkLength)))\n  }\n\n  // pad the end with zeros, but make sure to not forget the extra bytes\n  if (extraBytes === 1) {\n    tmp = uint8[len - 1]\n    parts.push(\n      lookup[tmp >> 2] +\n      lookup[(tmp << 4) & 0x3F] +\n      '=='\n    )\n  } else if (extraBytes === 2) {\n    tmp = (uint8[len - 2] << 8) + uint8[len - 1]\n    parts.push(\n      lookup[tmp >> 10] +\n      lookup[(tmp >> 4) & 0x3F] +\n      lookup[(tmp << 2) & 0x3F] +\n      '='\n    )\n  }\n\n  return parts.join('')\n}\n","import type { EventTypes } from './constants';\nimport { Events } from './constants';\n\nimport {\n  AuthenticationError, InvalidIdTokenError,\n  OIDCClientError\n} from './errors';\n\nimport type {\n  StateStore } from './helpers';\nimport {\n  EventEmitter,\n  InMemoryStateStore,\n  LocalStorageStateStore\n} from './helpers';\n\n\n\nimport { Timer } from './helpers/timer';\nimport type {\n  AuthRequestOptions, IEndpointConfiguration,\n  IPlusAuthClientOptions,\n  LogoutRequestOptions, PopupOptions, RevokeOptions, SessionChecker,\n  SessionMonitorOptions,\n  TokenRequestOption, TokenResponse, TokenType\n} from './interfaces';\n\nimport type {\n  RequestOptions } from './utils';\nimport {\n  request,\n  runIframe,\n  buildEncodedQueryString,\n  parseQueryUrl,\n  validateIdToken,\n  createSessionCheckerFrame,\n  nonUserClaims, generateRandom, deriveChallenge, isValidIssuer,\n} from './utils';\n\nimport { isResponseType, isScopeIncluded } from './utils/oidc';\nimport { runPopup } from './utils/popup';\nimport { TabUtils } from './utils/tab_utils';\n\n/**\n * `OIDCClient` provides methods for interacting with OIDC/OAuth2 authorization server. Those methods are signing a\n * user in, signing out, managing the user's claims, checking session and managing tokens returned from the\n * OIDC/OAuth2 provider.\n *\n */\nexport class OIDCClient extends EventEmitter<EventTypes>{\n  options: IPlusAuthClientOptions\n\n  user?: any;\n\n  scopes?: string[];\n\n  accessToken?: string;\n\n  refreshToken?: string;\n\n  idToken?: string;\n\n  idTokenRaw?: string;\n\n  issuer_metadata?: Record<string, any>;\n\n  private readonly http: ( options: RequestOptions ) => Promise<any> | never;\n\n  private synchronizer: TabUtils;\n\n  private stateStore: StateStore\n\n  private authStore: StateStore;\n\n  private sessionCheckerFrame?: SessionChecker\n\n  private _accessTokenExpireTimer?: Timer;\n\n  private initialized!: boolean;\n\n  private __initializePromise!: Promise<any> | undefined;\n\n  constructor( options: IPlusAuthClientOptions ) {\n    super()\n    if ( !isValidIssuer( options.issuer ) ){\n      throw new OIDCClientError( '\"issuer\" must be a valid uri.' )\n    }\n\n    this.synchronizer = new TabUtils( btoa( options.issuer ) )\n\n    this.options = Object.assign( {\n      secondsToRefreshAccessTokenBeforeExp: 60,\n      autoSilentRenew:                      true,\n      checkSession:                         true,\n    }, options, {\n      // remove last slash for consistency across the lib\n      issuer: options.issuer.endsWith( '/' ) ? options.issuer.slice( 0, -1 ) : options.issuer\n    } )\n\n    this.http = this.options.httpClient || request\n    this.stateStore = this.options.stateStore || new LocalStorageStateStore( 'pa_oidc.state.' )\n    this.authStore = this.options.authStore || new InMemoryStateStore()\n\n\n    if ( this.options.autoSilentRenew ){\n      this._accessTokenExpireTimer = new Timer()\n    }\n\n    this.on( Events.USER_LOGOUT, async ()=>{\n      this.user = undefined\n      this.scopes = undefined;\n      this.accessToken = undefined\n      this.idToken = undefined\n      this.refreshToken = undefined\n      await this.authStore.clear()\n    } )\n\n    this.synchronizer.OnBroadcastMessage( Events.USER_LOGIN, this.onUserLogin.bind( this ) )\n  }\n\n  /**\n   * Initialize the library with this method. It resolves issuer configuration, jwks keys which are necessary for\n   * validating tokens returned from provider and checking if a user is already authenticated in provider.\n   *\n   * @param checkLogin Make this `false` if you don't want to check user authorization status in provider while\n   * initializing. Defaults to `true`\n   */\n  async initialize( checkLogin = true ): Promise<OIDCClient> | never {\n    if ( this.initialized ){\n      return this\n    }\n\n    if ( this.__initializePromise ){\n      return this.__initializePromise\n    } else {\n      this.__initializePromise = new Promise( async ( resolve, reject ) => {\n        try {\n          if ( this.stateStore.init ){\n            await this.stateStore.init()\n          }\n          if ( this.authStore.init ){\n            await this.authStore.init()\n          }\n\n          if ( !this.options.endpoints || Object.keys( this.options.endpoints ).length === 0 ){\n            await this.fetchFromIssuer()\n          }\n          this.initialized = true\n\n          try {\n            if ( checkLogin ){\n              if ( !window?.frameElement ){\n                await this.silentLogin()\n              }\n            }\n          } catch ( e ) {\n            this.emit( Events.SILENT_RENEW_ERROR, e )\n            await this.authStore.clear()\n          }\n          resolve( this )\n        } catch ( e ) {\n          if ( e instanceof OIDCClientError ){\n            reject( e )\n          } else {\n            reject( new OIDCClientError( e.message ) )\n          }\n        } finally {\n          this.__initializePromise = undefined\n        }\n      } )\n    }\n\n    return this.__initializePromise\n  }\n\n  /**\n   * Redirect to provider's authorization endpoint using provided parameters. You can override any parameter defined\n   * in `OIDCClient`. If you don't provide `state`, `nonce` or `code_verifier` they will be generated automatically\n   * in a random and secure way.\n   *\n   * @param options\n   * @param localState\n   */\n  async login( options: Partial<AuthRequestOptions> = {}, localState: Record<string, any> = {} ){\n    window.location.assign( await this.createAuthRequest( options, localState ) )\n  }\n\n  /**\n   * Open a popup with the provider's authorization endpoint using provided parameters. You can override any\n   * parameter defined in `OIDCClient`. If you don't provide `state`, `nonce` or `code_verifier` they will be\n   * generated automatically in a random and secure way. You can also override popup options.\n   *\n   * NOTE: Most browsers block popups if they are not happened as a result of user actions. In order to display\n   * login popup you must call this method in an event handler listening for a user action like button click.\n   *\n   * @param options\n   * @param popupOptions\n   */\n  async loginWithPopup( options: Partial<AuthRequestOptions> = {}, popupOptions: PopupOptions = {} ){\n    const url = await this.createAuthRequest( {\n      response_mode: 'fragment',\n      ...options,\n      display:       'popup',\n      request_type:  'p'\n    } )\n    const { response, state } = await runPopup( url, popupOptions )\n    const { authParams, localState } = !state || typeof state === 'string' ?\n      await this.loadState( state || response.state )\n      : state;\n    const tokenResult = await this.handleAuthResponse( response, authParams, localState )\n    const authObject = await this.handleTokenResult(\n      tokenResult,\n      authParams,\n      Object.assign( {}, this.options, authParams )\n    )\n    authObject.session_state= response.session_state;\n    this.synchronizer.BroadcastMessageToAllTabs( Events.USER_LOGIN, authObject )\n    return localState\n  }\n\n  /**\n   * After a user successfully authorizes an application, the authorization server will redirect the user back to\n   * the application with either an authorization code or access token in the URL. In the callback page you should\n   * call this method.\n   *\n   * @param url Full url which contains authorization request result parameters. Defaults to `window.location.href`\n   */\n  async loginCallback( url: string= window?.location?.href ){\n    if ( !url ){\n      return Promise.reject( new OIDCClientError( 'Url must be passed to handle login redirect' ) )\n    }\n    let parsedUrl: URL;\n    try {\n      parsedUrl = new URL( url )\n    } catch ( e ){\n      return Promise.reject( new OIDCClientError( `Invalid callback url passed: \"${ url }\"` ) )\n    }\n\n    const responseParams = parseQueryUrl( parsedUrl.search || parsedUrl.hash )\n    const rawStoredState = await this.loadState( responseParams.state )\n    const { authParams, localState, request_type } = rawStoredState\n    url = url || window.location.href;\n    switch ( request_type ) {\n      case 's':\n        if ( window?.frameElement ) {\n          if ( url ) {\n            window.parent.postMessage( {\n              type:     'authorization_response',\n              response: responseParams,\n              state:    rawStoredState\n            }, `${ location.protocol }//${ location.host }` );\n          }\n        }\n        return\n      case 'p':\n        if ( window.opener && url ){\n          window.opener.postMessage( {\n            type:     'authorization_response',\n            response: responseParams,\n            state:    rawStoredState\n          }, `${ location.protocol }//${ location.host }` );\n        }\n        return\n      default:\n        if ( responseParams.error ){\n          return Promise.reject( new AuthenticationError( responseParams.error, responseParams.error_description ) )\n        }\n        const tokenResult = await this.handleAuthResponse( responseParams, authParams, localState )\n        const authObject = await this.handleTokenResult(\n          tokenResult,\n          authParams,\n          Object.assign( {}, this.options, authParams )\n        )\n        authObject.session_state= responseParams.session_state;\n        this.synchronizer.BroadcastMessageToAllTabs( Events.USER_LOGIN, authObject )\n        return localState\n    }\n  }\n\n  /**\n   * Redirect to provider's `end_session_endpoint` with provided parameters. After logout provider will redirect to\n   * provided `post_logout_redirect_uri` if it provided.\n   * @param options\n   */\n  async logout( options: LogoutRequestOptions = {} ){\n    if ( !options.localOnly ) {\n      const storedAuth = await this.authStore.get( 'auth' )\n      const id_token_hint = options.id_token_hint || storedAuth?.id_token_raw\n      window.location.assign( await this.createLogoutRequest( {\n        ...options,\n        id_token_hint\n      } ) )\n    }\n    await this.authStore.clear()\n  }\n\n  /**\n   * OAuth2 token revocation implementation method. See more at [tools.ietf.org/html/rfc7009](https://tools.ietf.org/html/rfc7009)\n   * @param token Token to be revoked\n   * @param type Passed token's type. It will be used to provide `token_type_hint` parameter.\n   * @param options If necessary override options passed to `OIDCClient` by defining them here.\n   */\n  async revokeToken( token: string, type: TokenType = 'access_token', options: RevokeOptions = {} ){\n    if ( !this.options.endpoints!.revocation_endpoint ){\n      return Promise.reject( new OIDCClientError( '\"revocation_endpoint\" doesn\\'t exist' ) )\n    }\n    const finalOptions = {\n      client_id:       options.client_id || this.options.client_id,\n      client_secret:   options.client_secret || this.options.client_secret,\n      token_type_hint: type,\n      token:           token\n    }\n\n    return this.http( {\n      method:      'POST',\n      requestType: 'form',\n      url:         this.options.endpoints!.revocation_endpoint,\n      body:        finalOptions\n    } )\n  }\n\n  /**\n   * Login without having an interaction. If refresh tokens are used and there is a stored refresh token it will\n   * exchange refresh token to receive new access token. If not it silently makes a request the provider's\n   * authorization endpoint using provided parameters. You can override any parameter defined in `OIDCClient`. If\n   * you don't provide `state`, `nonce` or `code_verifier` they will be generated automatically in a random and\n   * secure way.\n   *\n   * @param options\n   * @param localState\n   */\n  async silentLogin( options: AuthRequestOptions = {}, localState: Record<string, any> = {} ){\n    await this.initialize( false )\n    let tokenResult: any;\n    let finalState: any = {}\n\n    const storedAuth = await this.authStore.get( 'auth' ) || {}\n\n    const finalOptions = Object.assign( {}, this.options, options )\n\n    if ( finalOptions.silent_redirect_uri ){\n      finalOptions.redirect_uri = finalOptions.silent_redirect_uri\n    }\n\n    if ( this.options.useRefreshToken && storedAuth?.refresh_token ){\n      // TODO: deep merge\n      finalState.authParams = Object.assign( {}, storedAuth?.authParams || {}, finalState.authParams || {} )\n      tokenResult = await this.exchangeRefreshToken( {\n        ...finalOptions,\n        refresh_token: storedAuth.refresh_token,\n      } )\n    } else {\n      const authUrl = await this.createAuthRequest( {\n        response_mode: 'query',\n        display:       'page',\n        prompt:        'none',\n        ...finalOptions,\n        request_type:  's'\n      }, localState )\n\n      const { response, state } = await runIframe( authUrl, {\n        timeout:     finalOptions.silentRequestTimeout,\n        eventOrigin: window.location.origin\n      } )\n      tokenResult = await this.handleAuthResponse( response, finalOptions, localState )\n      storedAuth.session_state = response.session_state;\n      finalState = state\n    }\n\n    const authObject = await this.handleTokenResult( tokenResult, finalState.authParams, finalOptions )\n    authObject.session_state = storedAuth.session_state\n    this.synchronizer.BroadcastMessageToAllTabs( Events.USER_LOGIN, authObject )\n    return finalState.localState\n  }\n\n  /**\n   * Retrieve logged in user's access token if it exists.\n   */\n  async getAccessToken(){\n    return ( await this.authStore.get( 'auth' ) )?.access_token\n  }\n\n\n  /**\n   * Retrieve logged in user's refresh token if it exists.\n   */\n  async getRefreshToken(){\n    return ( await this.authStore.get( 'auth' ) )?.refresh_token\n  }\n\n  /**\n   * Retrieve logged in user's parsed id token if it exists.\n   */\n  async getIdToken(){\n    return ( await this.authStore.get( 'auth' ) )?.id_token\n  }\n\n  /**\n   * Retrieve access token's expiration.\n   */\n  async getExpiresAt(){\n    return ( await this.authStore.get( 'auth' ) )?.expires_at\n  }\n\n  /**\n   * Retrieve logged in user's id token in raw format if it exists.\n   */\n  async getIdTokenRaw(){\n    return ( await this.authStore.get( 'auth' ) )?.id_token_raw\n  }\n\n\n  /**\n   * Retrieve logged in user's scopes if it exists.\n   */\n  async getScopes(){\n    return ( await this.authStore.get( 'auth' ) )?.scope?.split( ' ' )\n  }\n\n\n  /**\n   * Retrieve logged in user's profile.\n   */\n  async getUser(){\n    return ( await this.authStore.get( 'auth' ) )?.user\n  }\n\n  /**\n   * If there is a user stored locally return true. Otherwise it will make a silentLogin to check if End-User is\n   * logged in provider.\n   *\n   * @param localOnly Don't check provider\n   */\n  async isLoggedIn( localOnly = false ){\n    const existsOnLocal = !!await this.getUser()\n    if ( !existsOnLocal && !localOnly ){\n      try {\n        await this.silentLogin()\n        return true\n      } catch ( e ){\n        return false\n      }\n    }\n    return existsOnLocal\n  }\n\n  /**\n   * Create authorization request with provided options.\n   *\n   * @param options\n   * @param localState\n   * @private\n   */\n  private async createAuthRequest( options: Partial<AuthRequestOptions> = {},\n    localState: Record<string, any> = {} ): Promise<string>{\n    if ( !this.options.endpoints?.authorization_endpoint ){\n      await this.initialize( false )\n    }\n    // TODO: deep merge for extra params\n    const finalOptions = Object.assign( {}, this.options, options )\n    localState.code_verifier = generateRandom( 72 )\n\n\n    const authParams: Record<string, any> = {\n      client_id:          finalOptions.client_id,\n      state:              generateRandom( 10 ),\n      scope:              finalOptions.scope,\n      audience:           finalOptions.audience,\n      redirect_uri:       finalOptions.redirect_uri,\n      response_mode:      finalOptions.response_mode,\n      response_type:      finalOptions.response_type || 'code',\n      ui_locales:         finalOptions.ui_locales,\n      prompt:             finalOptions.prompt,\n      display:            finalOptions.display,\n      claims:             finalOptions.claims,\n      claims_locales:     finalOptions.claims_locales,\n      acr_values:         finalOptions.acr_values,\n      registration:       finalOptions.registration,\n      login_hint:         finalOptions.login_hint,\n      id_token_hint:      finalOptions.id_token_hint,\n      web_message_uri:    finalOptions.web_message_uri,\n      web_message_target: finalOptions.web_message_target,\n      ...finalOptions.extraParams && finalOptions.extraParams\n    };\n\n    if ( isResponseType( 'id_token', authParams.response_type ) ||\n      isScopeIncluded( 'openid', authParams.scope ) ){\n      authParams.nonce = generateRandom( 10 )\n    }\n\n    if ( isResponseType( 'code', authParams.response_type ) ){\n      authParams.code_challenge= await deriveChallenge( localState.code_verifier )\n      authParams.code_challenge_method= finalOptions.code_challenge_method || 'S256'\n    }\n\n    const now = this.options.currentTimeInMillis && this.options.currentTimeInMillis() || Date.now()\n    const fragment = finalOptions.fragment ? `#${ finalOptions.fragment }` : '';\n    const authParamsString = buildEncodedQueryString( authParams )\n    const url = `${ this.options.endpoints!.authorization_endpoint }${ authParamsString }${ fragment }`\n\n    // clear 1 day old state entries\n    this.stateStore.clear( now - 86400000 )\n\n\n    await this.stateStore.set( authParams.state!, {\n      created_at:   now,\n      authParams,\n      localState,\n      request_type: finalOptions.request_type\n    } )\n    return url\n  }\n\n  /**\n   * Create a logout request with given options\n   *\n   * @param options\n   * @private\n   */\n  private async createLogoutRequest( options: LogoutRequestOptions = {} ){\n    if ( !this.options.endpoints?.end_session_endpoint ){\n      await this.fetchFromIssuer();\n    }\n    const finalOptions = Object.assign( {}, this.options, options )\n    const logoutParams = {\n      id_token_hint:            finalOptions.id_token_hint,\n      post_logout_redirect_uri: finalOptions.post_logout_redirect_uri,\n      ...finalOptions.extraLogoutParams || {}\n    }\n    return `${ this.options.endpoints!.end_session_endpoint }${ buildEncodedQueryString( logoutParams ) }`\n  }\n\n  /**\n   * Exchange authorization code retrieved from auth request result.\n   * @param options\n   * @private\n   */\n  private async exchangeAuthorizationCode( options: TokenRequestOption ){\n    if ( !this.options.endpoints?.token_endpoint ){\n      await this.fetchFromIssuer();\n    }\n    const { extraTokenHeaders, extraTokenParams, ...rest } = options\n    const mergedOptions = {\n      grant_type:    'authorization_code',\n      client_id:     this.options.client_id,\n      client_secret: this.options.client_secret,\n      redirect_uri:  this.options.redirect_uri,\n      ...rest,\n      ...extraTokenParams || {}\n    }\n\n    for ( const req of ['code', 'redirect_uri', 'code_verifier', 'client_id'] as const ){\n      if ( !mergedOptions[req] ){\n        return Promise.reject( new Error( `\"${ req }\" is required` ) );\n      }\n    }\n\n    return this.http( {\n      url:         `${ this.options.endpoints!.token_endpoint }`,\n      method:      'POST',\n      requestType: 'form',\n      body:        mergedOptions as any,\n      headers:     extraTokenHeaders\n    } )\n  }\n\n  /**\n   * Exchange refresh token with given options\n   * @param options\n   * @private\n   */\n  private async exchangeRefreshToken( options: Partial<TokenRequestOption> ) {\n    if ( !this.options.endpoints?.token_endpoint ){\n      await this.fetchFromIssuer();\n    }\n    const { extraTokenHeaders, extraTokenParams, ...rest } = options\n    const mergedOptions = {\n      grant_type:    'refresh_token',\n      client_id:     this.options.client_id,\n      client_secret: this.options.client_secret,\n      ...rest,\n      ...extraTokenParams || {}\n    }\n\n    for ( const req of ['refresh_token', 'client_id'] as const ){\n      if ( !mergedOptions[req] ){\n        return Promise.reject( new Error( `\"${ req }\" is required` ) );\n      }\n    }\n\n    return this.http( {\n      url:         `${ this.options.endpoints!.token_endpoint }`,\n      method:      'POST',\n      requestType: 'form',\n      body:        mergedOptions as any,\n      headers:     extraTokenHeaders\n    } );\n  }\n\n  /**\n   * Fetch OIDC configuration from the issuer.\n   */\n  private async fetchFromIssuer(): Promise<Record<string, any>>{\n    try {\n      const requestUrl = `${ this.options.issuer }/.well-known/openid-configuration`\n      const response = await this.http( {\n        url:         requestUrl,\n        method:      'GET',\n        requestType: 'json'\n      } )\n      this.issuer_metadata = response as Record<string, any>\n      const endpoints = {} as any\n      for ( const prop of Object.keys( this.issuer_metadata ) ) {\n        if ( prop.endsWith( '_endpoint' ) || prop.indexOf( '_session' ) > -1 || prop.indexOf( '_uri' ) > -1 ) {\n          endpoints[prop as keyof IEndpointConfiguration] = this.issuer_metadata[prop];\n        }\n      }\n      this.options.endpoints = endpoints\n      return this.issuer_metadata;\n    } catch ( e ) {\n      throw new OIDCClientError( 'Loading metadata failed', e.message )\n    }\n  }\n\n  /**\n   * Handle auth request result. If there is `code` exchange it.\n   * @param response\n   * @param finalOptions\n   * @param localState\n   * @private\n   */\n  private async handleAuthResponse( response: any, finalOptions: IPlusAuthClientOptions,\n    localState: Record<string, any> = {} ){\n    if ( response.code ){\n      return this.exchangeAuthorizationCode( {\n        redirect_uri:  finalOptions.redirect_uri,\n        client_id:     finalOptions.client_id,\n        client_secret: finalOptions.client_secret,\n        code_verifier: localState.code_verifier,\n        grant_type:    'authorization_code',\n        code:          response.code,\n      } );\n    } else {\n      return response\n    }\n  }\n\n  /**\n   * Handle OAuth2 auth request result\n   * @param tokenResult\n   * @param authParams\n   * @param finalOptions\n   * @private\n   */\n  private async handleTokenResult( tokenResult: TokenResponse, authParams: AuthRequestOptions,\n    finalOptions: IPlusAuthClientOptions ){\n    await this.initialize( false )\n    let user: any = {}\n    if ( tokenResult.error ){\n      throw new AuthenticationError( tokenResult.error, tokenResult.error_description )\n    }\n    let parsedIDToken: any;\n    if ( tokenResult.id_token ){\n      parsedIDToken = await validateIdToken( tokenResult.id_token, authParams.nonce!, finalOptions )\n      if ( finalOptions.idTokenValidator && !await finalOptions.idTokenValidator( tokenResult.id_token ) ){\n        return Promise.reject( new InvalidIdTokenError( 'Id Token validation failed' ) )\n      }\n      Object.keys( parsedIDToken ).forEach( key => {\n        if ( !nonUserClaims.includes( key as any ) ){\n          user[key] = parsedIDToken[key]\n        }\n      } )\n    }\n\n    if ( tokenResult.access_token ) {\n      if ( finalOptions.requestUserInfo && this.options.endpoints?.userinfo_endpoint ) {\n        const userInfoResult = await this.fetchUserInfo( tokenResult.access_token )\n        if ( !userInfoResult.error ){\n          user = { ...user, ...userInfoResult }\n        }\n      }\n    }\n\n    return {\n      authParams,\n      user,\n      ...tokenResult,\n      id_token:     parsedIDToken,\n      id_token_raw: tokenResult.id_token,\n      scope:        tokenResult.scope || authParams.scope,\n    }\n  }\n\n  /**\n   * Load stored state\n   *\n   * @param state\n   * @private\n   */\n  private async loadState( state: string ){\n    const rawStoredState = await this.stateStore.get( state )\n    if ( !rawStoredState ){\n      return Promise.reject( new AuthenticationError( `State not found: ${ state }` ) )\n    } else {\n      await this.stateStore.del( state )\n    }\n    return rawStoredState\n  }\n\n  /**\n   * Load user info by making request to providers `userinfo_endpoint`\n   *\n   * @param accessToken\n   * @private\n   */\n  private async fetchUserInfo( accessToken: string ){\n    return this.http( {\n      method:      'GET',\n      url:         `${ this.options.endpoints!.userinfo_endpoint }`,\n      requestType: 'json',\n      headers:     {\n        'Authorization': `Bearer ${ accessToken }`\n      }\n    } )\n  }\n\n  /**\n   * Start monitoring End-User's session if the OIDC provider supports session management. See more at [OIDC Session\n   * Management](https://openid.net/specs/openid-connect-session-1_0.html)\n   *\n   * @param sub End-User's id to for monitoring session\n   * @param session_state string that represents the End-User's login state at the OP\n   */\n  private monitorSession( { sub, session_state }: SessionMonitorOptions ){\n    const { client_id, endpoints } = this.options\n\n    if ( !endpoints?.check_session_iframe ){\n      console.warn( '\"check_session_iframe\" endpoint missing or session management is not supported by provider' )\n      return\n    }\n    if ( !this.sessionCheckerFrame ){\n      const sessionCheckCallback = async ( err: any )=>{\n        if ( err ){\n          this.emit( Events.USER_LOGOUT )\n        } else {\n          this.emit( Events.SESSION_CHANGE )\n          try {\n            await this.silentLogin( {}, {} )\n            const storedAuth = await this.authStore.get( 'auth' )\n            if ( storedAuth ){\n              if ( storedAuth?.user.sub === sub ){\n                this.sessionCheckerFrame!.start( storedAuth.session_state )\n              }\n            } else {\n              this.emit( Events.USER_LOGOUT, null )\n            }\n          } catch ( e ) {\n            this.emit( Events.USER_LOGOUT )\n            return\n          }\n        }\n      }\n\n      this.sessionCheckerFrame = createSessionCheckerFrame( {\n        url:           endpoints.check_session_iframe,\n        client_id:     client_id,\n        callback:      sessionCheckCallback,\n        checkInterval: this.options.checkSessionInterval,\n      } )\n    }\n\n    this.sessionCheckerFrame.start( session_state )\n  }\n\n  private async onUserLogin( authObj: any ){\n    const { expires_in, user, scope, access_token, id_token, refresh_token, session_state, id_token_raw } = authObj\n    await this.authStore.set( 'auth', authObj )\n\n    this.user = user\n    this.scopes = scope?.split( ' ' );\n    this.accessToken = access_token\n    this.idToken = id_token\n    this.idTokenRaw = id_token_raw\n    this.refreshToken = refresh_token\n\n    this.emit( Events.USER_LOGIN, authObj )\n    if ( !window?.frameElement ) {\n      if ( this.options.checkSession ) {\n        this.monitorSession( { sub: user.sub || user.id, session_state } )\n      }\n\n      if ( expires_in !== undefined && this.options.autoSilentRenew ){\n        const expiration = Number( expires_in ) - this.options.secondsToRefreshAccessTokenBeforeExp!\n        if ( expiration >= 0 ){\n          this._accessTokenExpireTimer!.start( expiration, async ()=> {\n            this.synchronizer.CallOnce( 'silent-login', async () => {\n              try {\n                await this.silentLogin()\n                this.emit( Events.SILENT_RENEW_SUCCESS, null )\n              } catch ( e ) {\n                this.emit( Events.SILENT_RENEW_ERROR, e )\n              }\n            } )\n          } )\n        }\n      }\n    }\n  }\n}\n","export default function(e,n){return n=n||{},new Promise(function(t,r){var s=new XMLHttpRequest,o=[],u=[],i={},a=function(){return{ok:2==(s.status/100|0),statusText:s.statusText,status:s.status,url:s.responseURL,text:function(){return Promise.resolve(s.responseText)},json:function(){return Promise.resolve(s.responseText).then(JSON.parse)},blob:function(){return Promise.resolve(new Blob([s.response]))},clone:a,headers:{keys:function(){return o},entries:function(){return u},get:function(e){return i[e.toLowerCase()]},has:function(e){return e.toLowerCase()in i}}}};for(var l in s.open(n.method||\"get\",e,!0),s.onload=function(){s.getAllResponseHeaders().replace(/^(.*?):[^\\S\\n]*([\\s\\S]*?)$/gm,function(e,n,t){o.push(n=n.toLowerCase()),u.push([n,t]),i[n]=i[n]?i[n]+\",\"+t:t}),t(a())},s.onerror=r,s.withCredentials=\"include\"==n.credentials,n.headers)s.setRequestHeader(l,n.headers[l]);s.send(n.body||null)})}\n//# sourceMappingURL=unfetch.module.js.map\n","module.exports = self.fetch || (self.fetch = require('unfetch').default || require('unfetch'));\n","import { fromByteArray } from 'base64-js';\n\nexport function isValidIssuer( issuer: string ){\n  try {\n    const url = new URL( issuer )\n    if ( !['http:', 'https:'].includes( url.protocol ) ){\n      return false\n    }\n    if ( url.search !== '' || url.hash !== '' ){\n      return false\n    }\n    return true\n  } catch ( e ){\n    return false\n  }\n}\nexport function buildEncodedQueryString( obj?: Record<string, any>,\n                                         appendable = true, ) {\n  if ( !obj ) return '';\n  const ret: string[] = [];\n  for ( const d in obj ) {\n    if ( obj.hasOwnProperty( d ) && obj[d] ) {\n      ret.push( `${\n        encodeURIComponent( d )\n      }=${\n        encodeURIComponent( typeof obj[d] === 'object' ? JSON.stringify( obj[d] ) : obj[d]! )\n      }` );\n    }\n  }\n  return `${ appendable ? '?' : '' }${ ret.join( '&' ) }`;\n}\n\nexport function parseQueryUrl( value: string ) {\n  const result: Record<string, string> = {};\n  value = value.trim().replace( /^(\\?|#|&)/, '' );\n  const params = value.split( '&' );\n  for ( let i = 0; i < params.length; i += 1 ) {\n    const paramAndValue = params[i];\n    const parts = paramAndValue.split( '=' );\n    const key = decodeURIComponent( parts.shift()! );\n    const value = parts.length > 0 ? parts.join( '=' ) : '';\n    result[key] = decodeURIComponent( value );\n  }\n  return result;\n}\n\nexport function urlSafe( buffer: Uint8Array ): string {\n  const encoded = fromByteArray( new Uint8Array( buffer ) );\n  return encoded.replace( /\\+/g, '-' ).replace( /\\//g, '_' ).replace( /=/g, '' );\n}\n","// eslint-disable-next-line import/default\nimport fetch from 'isomorphic-unfetch'\n\nimport { buildEncodedQueryString } from './url';\n\nexport interface RequestOptions {\n  body?: Record<string, string | number | null | undefined>;\n  headers?: Record<string, string>,\n  method: 'GET' | 'POST' | 'PATCH' | 'TRACE' | 'OPTIONS' | 'HEAD',\n  requestType?: 'form' | 'json',\n  url: string\n}\n\nexport function request( options: RequestOptions ): Promise<any>{\n  let body: any = null\n  let headers = options.headers || {}\n  if ( options.method === 'POST' ){\n    headers = {\n      'Content-Type': options.requestType === 'form' ? 'application/x-www-form-urlencoded;charset=UTF-8' :\n        'application/json;charset=UTF-8',\n      ...headers\n    }\n  }\n  if ( options.body ){\n    body = options.requestType === 'form' ? buildEncodedQueryString( options.body, false )\n      : JSON.stringify( options.body )\n  }\n\n  return new Promise( ( resolve, reject ) => {\n    fetch( options.url, {\n      method: options.method,\n      body:   body,\n      headers\n    } )\n      .then( ( value: Response ) => resolve( value.json() ) )\n      .catch( reject )\n  } )\n}\n","import { InvalidIdTokenError, InvalidJWTError, OIDCClientError } from '../errors';\nimport type { IPlusAuthClientOptions, JWTValidationOptions, ParsedJWT } from '../interfaces';\n\nimport { urlSafe } from './url';\n\nconst CHARSET = 'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789';\n\nfunction getRandomBytes( n: number ){\n  // @ts-ignore\n  const crypto = self.crypto || self.msCrypto, QUOTA = 65536;\n  const a = new Uint8Array( n );\n  for ( let i = 0; i < n; i += QUOTA ) {\n    crypto.getRandomValues( a.subarray( i, i + Math.min( n - i, QUOTA ) ) );\n  }\n  return a;\n}\n\nexport function generateRandom( length: number ){\n  let out = '';\n  const charsLen = CHARSET.length;\n  const maxByte = 256 - 256 % charsLen;\n  while ( length > 0 ) {\n    const buf = getRandomBytes( Math.ceil( length * 256 / maxByte ) );\n    for ( let i = 0; i < buf.length && length > 0; i++ ) {\n      const randomByte = buf[i];\n      if ( randomByte < maxByte ) {\n        out += CHARSET.charAt( randomByte % charsLen );\n        length--;\n      }\n    }\n  }\n  return out;\n}\n\n\nexport function deriveChallenge( code: string ): Promise<string>{\n  if ( code.length < 43 || code.length > 128 ) {\n    return Promise.reject( new OIDCClientError( `Invalid code length: ${ code.length }` ) );\n  }\n\n  return new Promise( ( resolve, reject ) => {\n    crypto.subtle.digest( 'SHA-256', new TextEncoder().encode( code ) )\n      .then( buffer => {\n        return resolve( urlSafe( new Uint8Array( buffer ) ) );\n      }, function ( error ) {\n        /* istanbul ignore next */\n        return reject( error );\n      } );\n  } );\n}\n// https://datatracker.ietf.org/doc/html/rfc4648#section-5\nexport const urlDecodeB64 = ( input: string ) => decodeURIComponent(\n  atob( input.replace( /_/g, '/' ).replace( /-/g, '+' ) )\n    .split( '' )\n    .map( c => {\n      return `%${ `00${ c.charCodeAt( 0 ).toString( 16 ) }`.slice( -2 ) }`;\n    } )\n    .join( '' )\n);\n\n\n\nexport function parseJwt( jwt: string ): ParsedJWT {\n  try {\n    const parts = jwt.split( '.' )\n    if ( parts.length !== 3 ){\n      throw new Error( 'Wrong JWT format' )\n    }\n    return {\n      header:  JSON.parse( urlDecodeB64( parts[0] ) ),\n      payload: JSON.parse( urlDecodeB64( parts[1] ) )\n    }\n  } catch ( e ){\n    throw new InvalidJWTError( 'Failed to parse jwt' )\n  }\n}\n\nexport function validateIdToken( id_token: string, nonce: string, options: IPlusAuthClientOptions ) {\n  if ( !nonce ) {\n    throw new OIDCClientError( 'No nonce on state' );\n  }\n\n  try {\n    const jwt = parseJwt( id_token );\n\n    if ( nonce !== jwt.payload.nonce ) {\n      throw new Error( `Invalid nonce in id_token: ${ jwt.payload.nonce }` );\n    }\n\n    validateJwt( id_token, options, true )\n\n    // @ts-ignore\n    if ( !jwt.payload['sub'] ) {\n      throw new Error( 'No Subject (sub) present in id_token' );\n    }\n\n    return jwt.payload;\n  } catch ( e ){\n    throw new InvalidIdTokenError( e.message )\n  }\n}\n\nexport function validateJwt( jwt: string, options: JWTValidationOptions, isIdToken = false ) {\n  // eslint-disable-next-line prefer-const\n  let { clockSkew, currentTimeInMillis, issuer, audience, client_id } = options\n  if ( !clockSkew ){\n    clockSkew = 0\n  }\n  const now = ( currentTimeInMillis && currentTimeInMillis() || Date.now() ) / 1000;\n\n  const payload = parseJwt( jwt ).payload;\n\n  if ( !payload.iss ) {\n    throw new InvalidJWTError( 'Issuer (iss) was not provided' );\n  }\n  if ( payload.iss !== issuer ) {\n    throw new InvalidJWTError( `Invalid Issuer (iss) in token: ${ payload.iss }` );\n  }\n\n  if ( !payload.aud ) {\n    throw new InvalidJWTError( 'Audience (aud) was not provided' );\n  }\n\n  // Audience must be equal to client_id in id_token\n  // https://openid.net/specs/openid-connect-core-1_0.html#IDToken\n  if ( Array.isArray( payload.aud ) ?\n    payload.aud.indexOf( isIdToken ? client_id : audience || client_id ) == -1 :\n    payload.aud !== ( isIdToken ? client_id : audience || client_id )\n  ) {\n    throw new InvalidJWTError( `Invalid Audience (aud) in token: ${ payload.aud }` );\n  }\n\n  if ( payload.azp && payload.azp !== client_id ) {\n    throw new InvalidJWTError( `Invalid Authorized Party (azp) in token: ${ payload.azp }` );\n  }\n\n  const lowerNow = Math.ceil( now + clockSkew );\n  const upperNow = Math.floor( now - clockSkew );\n\n  if ( !payload.iat ) {\n    throw new InvalidJWTError( 'Issued At (iat) was not provided' );\n  }\n\n  if ( lowerNow < Number( payload.iat ) ) {\n    throw new InvalidJWTError( `Issued At (iat) is in the future: ${ payload.iat }` );\n  }\n\n  if ( payload.nbf && lowerNow < Number( payload.nbf ) ) {\n    throw new InvalidJWTError( `Not Before time (nbf) is in the future: ${ payload.nbf }` );\n  }\n\n  if ( !payload.exp ) {\n    throw new InvalidJWTError( 'Expiration Time (exp) was not provided' );\n  }\n  if ( Number( payload.exp ) < upperNow ) {\n    throw new InvalidJWTError( `Expiration Time (exp) is in the past: ${ payload.exp }` );\n  }\n\n  return payload;\n}\n\n// Retrieved from https://www.iana.org/assignments/jwt/jwt.xhtml\nexport const nonUserClaims = [\n  'iss',\n  // 'sub',\n  'aud',\n  'exp',\n  'nbf',\n  'iat',\n  'jti',\n  'azp',\n  'nonce',\n  'auth_time',\n  'at_hash',\n  'c_hash',\n  'acr',\n  'amr',\n  'sub_jwk',\n  'cnf',\n  'sip_from_tag',\n  'sip_date',\n  'sip_callid',\n  'sip_cseq_num',\n  'sip_via_branch',\n  'orig',\n  'dest',\n  'mky',\n  'events',\n  'toe',\n  'txn',\n  'rph',\n  'sid',\n  'vot',\n  'vtm',\n  'attest',\n  'origid',\n  'act',\n  'scope',\n  'client_id',\n  'may_act',\n  'jcard',\n  'at_use_nbr',\n] as const\n","export const isResponseType = ( type: string, response_type?: string ) =>\n  response_type && response_type.split( /\\s+/g ).filter( rt => rt === type ).length > 0\n\nexport const isScopeIncluded = ( scope: string, scopes?: string ) =>\n  scopes && scopes.split( ' ' ).indexOf( scope ) > -1\n","import { InteractionCancelled, OIDCClientError } from '../errors';\nimport type { PopupOptions } from '../interfaces';\n\nconst openPopup = ( url: string, width = 400, height = 600 ) => {\n  const left = window.screenX + ( window.innerWidth - width ) / 2;\n  const top = window.screenY + ( window.innerHeight - height ) / 2;\n\n  return window.open(\n    url,\n    'oidc-login-popup',\n    `left=${ left },top=${ top },width=${ width },height=${ height },resizable,scrollbars=yes,status=1`\n  );\n};\n\nexport function runPopup( url: string, options: PopupOptions ) {\n  let popup = options.popup;\n\n  if ( popup ) {\n    popup.location.href = url;\n  } else {\n    popup = openPopup( url );\n  }\n\n  if ( !popup ) {\n    /* istanbul ignore next */\n    throw new Error( 'Could not open popup' );\n  }\n\n  let timeoutId: any ;\n  let closeId: any ;\n\n  return new Promise<any>( ( resolve, reject ) => {\n    function clearHandlers(){\n      clearInterval( closeId );\n      clearTimeout( timeoutId )\n      window.removeEventListener( 'message', messageListener )\n    }\n\n    timeoutId = setTimeout( () => {\n      clearHandlers()\n      reject( new OIDCClientError( 'Timed out' ) );\n    }, options.timeout || 60 * 1000 )\n\n    closeId = setInterval( function () {\n      if ( popup!.closed ) {\n        clearHandlers()\n        reject( new InteractionCancelled( 'user closed popup' ) )\n      }\n    }, 300 );\n\n    window.addEventListener( 'message', messageListener );\n\n    function messageListener( e: MessageEvent ){\n      if ( !e.data || e.data.type !== 'authorization_response' ) return;\n      clearHandlers();\n      popup!.close();\n      const data = e.data.response || e.data\n      data.error ? reject( new OIDCClientError( data.error, data.error_description ) )\n        : resolve( e.data );\n    }\n  } );\n}\n","/*\nJitbit TabUtils - helper for multiple browser tabs. version 1.0\nhttps://github.com/jitbit/TabUtils\n- executing \"interlocked\" function call - only once per multiple tabs\n- broadcasting a message to all tabs (including the current one) with some message \"data\"\n- handling a broadcasted message\nMIT license: https://github.com/jitbit/TabUtils/blob/master/LICENSE\n*/\n\nconst currentTabId = `${ performance.now() }:${ Math.random() * 1000000000 | 0 }`;\nconst handlers: Record<string, any> = {};\n\nexport class TabUtils {\n  keyPrefix: string;\n\n  constructor( kid: string ) {\n    this.keyPrefix = kid;\n  }\n\n  //runs code only once in multiple tabs\n  //the lock holds for 4 seconds (in case the function is async and returns right away, for example, an ajax call intiated)\n  //then it is cleared\n  CallOnce( lockname: string, fn: () => void, timeout = 3000 ): void{\n    if ( !lockname ) throw 'empty lockname';\n\n    if ( !window.localStorage ) { //no local storage. old browser. screw it, just run the function\n      fn();\n      return;\n    }\n\n    const localStorageKey = this.keyPrefix + lockname;\n\n    localStorage.setItem( localStorageKey, currentTabId );\n    //re-read after a delay (after all tabs have saved their tabIDs into ls)\n    setTimeout( () => {\n      if ( localStorage.getItem( localStorageKey ) == currentTabId )\n        fn();\n    }, 150 );\n\n    //cleanup - release the lock after 3 seconds and on window unload (just in case user closed the window while the lock is still held)\n    setTimeout( function () { localStorage.removeItem( localStorageKey ); }, timeout );\n  }\n\n  BroadcastMessageToAllTabs( messageId: string, eventData: any ): void{\n    //now we also need to manually execute handler in the current tab too, because current tab does not get 'storage' events\n    try { handlers[messageId]( eventData ); } //\"try\" in case handler not found\n    catch ( x ) { }\n\n    if ( !window.localStorage ) return; //no local storage. old browser\n\n    const data = {\n      data:      eventData,\n      timeStamp: new Date().getTime()\n    }; //add timestamp because overwriting same data does not trigger the event\n\n    //this triggers 'storage' event for all other tabs except the current tab\n    localStorage.setItem( `${ this.keyPrefix }event${ messageId }`, JSON.stringify( data ) );\n\n    //cleanup\n    setTimeout( () => { localStorage.removeItem( `${ this.keyPrefix }event${ messageId }` ); }, 3000 );\n  }\n\n  OnBroadcastMessage( messageId: string, fn: ( data: any ) => void ): void{\n    handlers[messageId] = fn;\n    if ( !window.localStorage ) return; //no local storage. old browser\n\n    //first register a handler for \"storage\" event that we trigger above\n    window.addEventListener( 'storage', ( ev ) => {\n      if ( ev.key != `${ this.keyPrefix }event${ messageId }` ) return; // ignore other keys\n      if ( !ev.newValue ) return; //called by cleanup?\n      const messageData = JSON.parse( ev.newValue );\n      fn( messageData.data );\n    } );\n  }\n}\n","import type { SessionChecker, SessionCheckerOptions } from '../interfaces';\n\nimport { createHiddenFrame } from './iframe';\n\nconst DEFAULT_CHECK_INTERVAL = 2000\n\nexport function createSessionCheckerFrame( options: SessionCheckerOptions ): SessionChecker{\n  const { url, callback, client_id, checkInterval } = options\n  let internalSessionState: string | null;\n  const idx = url.indexOf( '/', url.indexOf( '//' ) + 2 );\n  const frameOrigin = url.substr( 0, idx );\n\n  const frame = createHiddenFrame()\n\n  let timer: any\n\n  const load = () => {\n    return new Promise( resolve => {\n      window.document.body.appendChild( frame );\n      window.addEventListener( 'message', iframeEventHandler, false );\n      frame.onload = () => {\n        resolve( null )\n      }\n    } )\n  }\n\n  const start = ( sessionState: string ) => {\n    load().then( () => {\n      if ( sessionState && internalSessionState !== sessionState ) {\n        stop();\n        internalSessionState = sessionState;\n        const send = () => {\n          frame.contentWindow!.postMessage( `${ client_id } ${ internalSessionState }`, frameOrigin );\n        };\n        send();\n        timer = window.setInterval( send, checkInterval || DEFAULT_CHECK_INTERVAL );\n      }\n    } )\n  }\n\n  const stop = () => {\n    internalSessionState = null;\n    if ( timer ) {\n      window.clearInterval( timer );\n      timer = null;\n    }\n  }\n\n  const iframeEventHandler = ( e: MessageEvent ) => {\n    if ( e.origin === frameOrigin && e.source === frame.contentWindow ) {\n      if ( e.data === 'error' ) {\n        stop();\n        callback( e.data );\n      } else if ( e.data === 'changed' ) {\n        stop();\n        callback();\n      }\n    }\n  }\n\n  frame.setAttribute( 'src', url );\n\n  return {\n    stop,\n    start\n  }\n}\n","import { OIDCClient } from './client';\nimport type { IPlusAuthClientOptions } from './interfaces';\n\nexport * from './interfaces'\nexport * from './client'\nexport * from './constants'\nexport * from './helpers'\nexport * from './errors'\n\n/**\n * Create OIDC client with initializing it. It resolves issuer metadata, jwks keys and check if user is\n * authenticated in OpenId Connect provider.\n */\nexport default function createOIDCClient( options: IPlusAuthClientOptions ): Promise<OIDCClient>{\n  return new OIDCClient( options ).initialize()\n}\n"],"names":["Events","USER_LOGOUT","USER_LOGIN","SILENT_RENEW_SUCCESS","SILENT_RENEW_ERROR","SESSION_CHANGE","OIDCClientError","Error","constructor","error","error_description","name","AuthenticationError","state","error_uri","InvalidJWTError","details","InvalidIdTokenError","InteractionCancelled","StateStore","prefix","LocalStorageStateStore","get","key","Promise","resolve","value","window","localStorage","getItem","JSON","parse","set","setItem","stringify","del","removeItem","clear","before","i","storedKeys","length","substring","push","storedItem","created_at","e","InMemoryStateStore","map","forEach","val","ind","delete","Map","EventEmitter","once","event","fn","on","onArgs","off","apply","cb","callbacks","splice","emit","args","cbs","slice","len","Timer","start","duration","callback","expiration","now","_expiration","_timerHandle","stop","timerDuration","setInterval","clearInterval","currentTimeInMillisFunc","Date","_defineProperty","createHiddenFrame","iframe","document","createElement","style","width","height","position","visibility","display","title","ariaHidden","n","t","r","s","XMLHttpRequest","o","u","a","ok","status","statusText","url","responseURL","text","responseText","json","then","blob","Blob","response","clone","headers","keys","entries","toLowerCase","has","l","open","method","onload","getAllResponseHeaders","replace","onerror","withCredentials","credentials","setRequestHeader","send","body","browser","self","fetch","require$$0","default","lookup","code","buildEncodedQueryString","obj","appendable","ret","d","hasOwnProperty","encodeURIComponent","join","request","options","requestType","reject","catch","CHARSET","generateRandom","out","charsLen","maxByte","buf","getRandomBytes","crypto","msCrypto","Uint8Array","getRandomValues","subarray","Math","min","ceil","randomByte","charAt","urlDecodeB64","input","decodeURIComponent","atob","split","c","charCodeAt","toString","parseJwt","jwt","parts","header","payload","nonUserClaims","isResponseType","type","response_type","filter","rt","isScopeIncluded","scope","scopes","indexOf","openPopup","left","screenX","innerWidth","top","screenY","innerHeight","currentTabId","performance","random","handlers","TabUtils","CallOnce","lockname","timeout","localStorageKey","keyPrefix","setTimeout","BroadcastMessageToAllTabs","messageId","eventData","x","data","timeStamp","getTime","OnBroadcastMessage","addEventListener","ev","newValue","messageData","kid","OIDCClient","initialize","checkLogin","initialized","__initializePromise","stateStore","init","authStore","endpoints","Object","fetchFromIssuer","frameElement","silentLogin","message","undefined","login","localState","location","assign","createAuthRequest","loginWithPopup","popupOptions","response_mode","request_type","runPopup","timeoutId","closeId","popup","href","clearHandlers","clearTimeout","removeEventListener","messageListener","close","closed","authParams","loadState","tokenResult","handleAuthResponse","authObject","handleTokenResult","session_state","synchronizer","loginCallback","parsedUrl","URL","responseParams","parseQueryUrl","result","trim","params","paramAndValue","shift","search","hash","rawStoredState","parent","postMessage","protocol","host","opener","logout","localOnly","storedAuth","id_token_hint","id_token_raw","createLogoutRequest","revokeToken","token","revocation_endpoint","finalOptions","client_id","client_secret","token_type_hint","http","finalState","silent_redirect_uri","redirect_uri","useRefreshToken","refresh_token","exchangeRefreshToken","authUrl","prompt","silentRequestTimeout","eventOrigin","origin","onLoadTimeoutId","timeoutSetTimeoutId","removeIframe","iframeEventHandler","eventSource","source","resp","contains","removeChild","onLoadTimeout","appendChild","setAttribute","getAccessToken","_ref","access_token","getRefreshToken","getIdToken","id_token","getExpiresAt","expires_at","getIdTokenRaw","getScopes","_ref_scope","getUser","user","isLoggedIn","existsOnLocal","_this_options_endpoints","authorization_endpoint","code_verifier","audience","ui_locales","claims","claims_locales","acr_values","registration","login_hint","web_message_uri","web_message_target","extraParams","nonce","code_challenge","subtle","digest","TextEncoder","encode","buffer","urlSafe","encoded","fromByteArray","uint8","tmp","extraBytes","len2","encodeChunk","end","output","num","code_challenge_method","currentTimeInMillis","fragment","authParamsString","end_session_endpoint","logoutParams","post_logout_redirect_uri","extraLogoutParams","exchangeAuthorizationCode","token_endpoint","extraTokenHeaders","extraTokenParams","rest","mergedOptions","grant_type","req","requestUrl","issuer","issuer_metadata","prop","endsWith","parsedIDToken","validateIdToken","validateJwt","isIdToken","clockSkew","iss","aud","Array","isArray","azp","lowerNow","upperNow","floor","iat","Number","nbf","exp","idTokenValidator","includes","requestUserInfo","userinfo_endpoint","userInfoResult","fetchUserInfo","accessToken","monitorSession","sub","check_session_iframe","console","warn","sessionCheckerFrame","sessionCheckCallback","err","createSessionCheckerFrame","internalSessionState","timer","checkInterval","idx","frameOrigin","substr","frame","load","sessionState","contentWindow","checkSessionInterval","onUserLogin","authObj","expires_in","idToken","idTokenRaw","refreshToken","checkSession","id","autoSilentRenew","secondsToRefreshAccessTokenBeforeExp","_accessTokenExpireTimer","isValidIssuer","btoa","httpClient","bind"],"mappings":"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","x_google_ignoreList":[8,10,11]}