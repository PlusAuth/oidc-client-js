{"version":3,"file":"oidc-client.min.js","sources":["../src/constants/events.ts","../src/errors.ts","../src/helpers/state_manager/state_store.ts","../src/helpers/state_manager/local_storage.ts","../src/helpers/state_manager/in_memory.ts","../src/helpers/event_emitter.ts","../src/helpers/timer.ts","../src/utils/iframe.ts","../src/client.ts","../node_modules/.pnpm/base64-js@1.5.1/node_modules/base64-js/index.js","../src/utils/url.ts","../src/utils/request.ts","../src/utils/jose.ts","../src/utils/object.ts","../src/utils/oidc.ts","../src/utils/popup.ts","../src/utils/tab_utils.ts","../src/utils/check_session_iframe.ts","../src/index.ts"],"sourcesContent":["/* eslint-disable @typescript-eslint/indent */\nexport const Events = {\n  USER_LOGOUT: \"user_logout\",\n  USER_LOGIN: \"user_login\",\n  SILENT_RENEW_SUCCESS: \"silent_renew_success\",\n  SILENT_RENEW_ERROR: \"silent_renew_error\",\n  SESSION_CHANGE: \"session_change\",\n} as const\n\nexport type EventTypes =\n  | \"user_logout\"\n  | \"user_login\"\n  | \"silent_renew_success\"\n  | \"silent_renew_error\"\n  | \"session_change\"\n  | \"session_error\"\n","export class OIDCClientError extends Error {\n  error: string\n\n  error_description?: string\n\n  public constructor(error: string, error_description?: string) {\n    super(`${error}${(error_description && ` - ${error_description}`) || \"\"}`)\n    this.name = \"OIDCClientError\"\n    this.error = error\n    this.error_description = error_description\n  }\n}\n\nexport class AuthenticationError extends OIDCClientError {\n  state?: string\n\n  error_uri?: string\n\n  constructor(error: string, error_description?: string, state?: string, error_uri?: string) {\n    super(error, error_description)\n    this.name = \"AuthenticationError\"\n    this.state = state\n    this.error_uri = error_uri\n  }\n}\n\nexport class StateNotFound extends AuthenticationError {\n  state?: string\n\n  constructor(error: string, state?: string) {\n    super(error)\n    this.name = \"StateNotFound\"\n    this.state = state\n  }\n}\n\nexport class InvalidJWTError extends OIDCClientError {\n  constructor(details: string) {\n    super(details)\n    this.name = \"InvalidJWTError\"\n    this.error_description = details\n  }\n}\n\nexport class InvalidIdTokenError extends InvalidJWTError {\n  constructor(details: string) {\n    super(details)\n    this.name = \"InvalidIdTokenError\"\n  }\n}\n\nexport class InteractionCancelled extends OIDCClientError {\n  constructor(details: string) {\n    super(details)\n    this.name = \"InteractionCancelled\"\n  }\n}\n","export interface StateStore<T = Record<string, any>> {\n  init?(): Promise<StateStore<T>>\n}\n// biome-ignore  lint/suspicious/noUnsafeDeclarationMerging:\nexport abstract class StateStore<T = Record<string, any>> {\n  prefix: string\n\n  constructor(prefix = \"\") {\n    this.prefix = prefix\n  }\n\n  public abstract get(key: string): Promise<T | null>\n\n  public abstract set(key: string, value: T): Promise<void>\n\n  public abstract del(key: string): Promise<void>\n\n  public abstract clear(maxAge?: number): Promise<void>\n}\n","import { StateStore } from \"./state_store\"\n\nexport class LocalStorageStateStore<T = any> extends StateStore<T> {\n  constructor(prefix = \"pa_oidc.\") {\n    super(prefix)\n  }\n\n  get(key: string) {\n    return new Promise<T | null>((resolve) => {\n      const value = window.localStorage.getItem(this.prefix + key)\n      if (value) {\n        resolve(JSON.parse(value))\n      } else {\n        resolve(null)\n      }\n    })\n  }\n\n  set(key: string, value: T) {\n    return new Promise<void>((resolve) => {\n      window.localStorage.setItem(this.prefix + key, JSON.stringify(value))\n      resolve()\n    })\n  }\n\n  del(key: string) {\n    return new Promise<void>((resolve) => {\n      window.localStorage.removeItem(this.prefix + key)\n      resolve()\n    })\n  }\n\n  clear(before?: number): Promise<void> {\n    return new Promise<void>((resolve) => {\n      let i\n      const storedKeys: string[] = []\n      for (i = 0; i < window.localStorage.length; i++) {\n        const key = window.localStorage.key(i)\n        // items only created by oidc client\n        if (key?.substring(0, this.prefix.length) === this.prefix) {\n          storedKeys.push(key)\n        }\n      }\n      for (i = 0; i < storedKeys.length; i++) {\n        if (before) {\n          try {\n            const storedItem = JSON.parse(window.localStorage.getItem(storedKeys[i])!)\n            if (storedItem.created_at < before) {\n              window.localStorage.removeItem(storedKeys[i])\n            }\n          } catch (e) {}\n        } else {\n          window.localStorage.removeItem(storedKeys[i])\n        }\n      }\n      resolve()\n    })\n  }\n}\n","import { StateStore } from \"./state_store\"\n\nexport class InMemoryStateStore<T = any> extends StateStore<T> {\n  map = new Map()\n\n  clear(before?: number) {\n    if (before) {\n      this.map.forEach((val, ind) => {\n        if (val.created_at < before) {\n          this.map.delete(ind)\n        }\n      })\n      return Promise.resolve()\n    }\n    return Promise.resolve(this.map.clear())\n  }\n\n  del(key: string) {\n    this.map.delete(key)\n    return Promise.resolve()\n  }\n\n  get(key: string) {\n    return Promise.resolve(this.map.get(key) || null)\n  }\n\n  set(key: string, value: any) {\n    this.map.set(key, value)\n    return Promise.resolve()\n  }\n}\n","export type Listener = (...args: any) => void\n\nexport class EventEmitter<T extends string> {\n  callbacks: Record<string, any[]>\n\n  constructor() {\n    this.callbacks = {}\n  }\n\n  once(event: T, fn: (...args: any[]) => void) {\n    function on(this: EventEmitter<any>, ...onArgs: any[]) {\n      this.off(event, on)\n      fn.apply(this, onArgs)\n    }\n    on.fn = fn\n    this.on(event, on)\n    return this\n  }\n\n  on(event: T, cb: (...args: any[]) => void) {\n    if (!this.callbacks[`$${event}`]) this.callbacks[`$${event}`] = []\n    this.callbacks[`$${event}`].push(cb)\n    return this\n  }\n\n  off(event?: T, fn?: (...args: any[]) => void) {\n    if (!event) {\n      this.callbacks = {}\n      return this\n    }\n\n    // specific event\n    const callbacks = this.callbacks[`$${event}`]\n    if (!callbacks) return this\n\n    // remove all handlers\n    if (!fn) {\n      delete this.callbacks[`$${event}`]\n      return this\n    }\n\n    for (let i = 0; i < callbacks.length; i++) {\n      const cb = callbacks[i]\n      if (cb === fn || cb.fn === fn) {\n        callbacks.splice(i, 1)\n        break\n      }\n    }\n\n    // Remove event specific arrays for event types that no\n    // one is subscribed for to avoid memory leak.\n    if (callbacks.length === 0) {\n      delete this.callbacks[`$${event}`]\n    }\n\n    return this\n  }\n\n  emit(event: T, ...args: any[]) {\n    let cbs = this.callbacks[`$${event}`]\n    if (cbs) {\n      cbs = cbs.slice(0)\n      for (let i = 0, len = cbs.length; i < len; ++i) {\n        cbs[i].apply(this, args)\n      }\n    }\n    return this\n  }\n}\n","export class Timer {\n  private now: () => number\n\n  private _timerHandle: any\n\n  private _expiration!: number\n\n  constructor(currentTimeInMillisFunc = () => Date.now()) {\n    this.now = currentTimeInMillisFunc\n  }\n\n  start(duration: number, callback: () => void) {\n    if (duration <= 0) {\n      duration = 1\n    }\n    const expiration = this.now() / 1000 + duration\n    if (this._expiration === expiration && this._timerHandle) {\n      return\n    }\n\n    this.stop()\n\n    this._expiration = expiration\n\n    // prevent device sleep and delayed timers\n    let timerDuration = 5\n    if (duration < timerDuration) {\n      timerDuration = duration\n    }\n    this._timerHandle = setInterval(() => {\n      if (this._expiration <= this.now() / 1000) {\n        this.stop()\n        callback()\n      }\n    }, timerDuration * 1000)\n  }\n\n  stop() {\n    if (this._timerHandle) {\n      clearInterval(this._timerHandle)\n      this._timerHandle = null\n    }\n  }\n}\n","import { AuthenticationError, OIDCClientError } from \"../errors\"\nimport type { IFrameOptions } from \"../interfaces\"\n\nexport function createHiddenFrame() {\n  const iframe = window.document.createElement(\"iframe\")\n  iframe.style.width = \"0\"\n  iframe.style.height = \"0\"\n  iframe.style.position = \"absolute\"\n  iframe.style.visibility = \"hidden\"\n  iframe.style.display = \"none\"\n\n  iframe.title = \"__pa_helper__hidden\"\n  iframe.ariaHidden = \"true\"\n\n  return iframe\n}\n\nexport function runIframe(url: string, options: IFrameOptions) {\n  return new Promise<any>((resolve, reject) => {\n    let onLoadTimeoutId: any = null\n    const iframe = createHiddenFrame()\n\n    const timeoutSetTimeoutId = setTimeout(\n      () => {\n        reject(new OIDCClientError(\"Timed out\"))\n        removeIframe()\n      },\n      (options.timeout || 10) * 1000,\n    )\n\n    const iframeEventHandler = (e: MessageEvent) => {\n      if (e.origin !== options.eventOrigin) return\n      if (!e.data || e.data.type !== \"authorization_response\") return\n      const eventSource = e.source\n      if (eventSource) {\n        ;(<any>eventSource).close()\n      }\n\n      const resp = e.data.response || e.data\n      resp.error\n        ? reject(\n            new AuthenticationError(resp.error, resp.error_description, resp.state, resp.error_uri),\n          )\n        : resolve(e.data)\n      clearTimeout(timeoutSetTimeoutId)\n      removeIframe()\n    }\n\n    const removeIframe = () => {\n      if (onLoadTimeoutId != null) {\n        clearTimeout(onLoadTimeoutId)\n      }\n      if (window.document.body.contains(iframe)) {\n        window.document.body.removeChild(iframe)\n      }\n      window.removeEventListener(\"message\", iframeEventHandler, false)\n    }\n\n    const onLoadTimeout = () =>\n      setTimeout(() => {\n        reject(new OIDCClientError(\"Could not complete silent authentication\", url))\n        removeIframe()\n      }, 300)\n\n    window.addEventListener(\"message\", iframeEventHandler, false)\n    window.document.body.appendChild(iframe)\n    iframe.setAttribute(\"src\", url)\n\n    /**\n     * In case of wrong client id, wrong redirect_uri, in short when redirect did not happen\n     * we assume flow failed.\n     */\n    iframe.onload = () => {\n      onLoadTimeoutId = onLoadTimeout()\n    }\n  })\n}\n","import type { EventTypes } from \"./constants\"\nimport { Events } from \"./constants\"\n\nimport { AuthenticationError, InvalidIdTokenError, OIDCClientError, StateNotFound } from \"./errors\"\n\nimport type { StateStore } from \"./helpers\"\nimport { EventEmitter, InMemoryStateStore, LocalStorageStateStore } from \"./helpers\"\n\nimport { Timer } from \"./helpers/timer\"\nimport type {\n  AuthRecord,\n  AuthRequestOptions,\n  IEndpointConfiguration,\n  IPlusAuthClientOptions,\n  LogoutRequestOptions,\n  PopupOptions,\n  RevokeOptions,\n  SessionChecker,\n  SessionMonitorOptions,\n  StateRecord,\n  TokenRequestOption,\n  TokenResponse,\n  TokenType,\n} from \"./interfaces\"\n\nimport type { RequestOptions } from \"./utils\"\nimport {\n  buildEncodedQueryString,\n  createSessionCheckerFrame,\n  deriveChallenge,\n  generateRandom,\n  isValidIssuer,\n  nonUserClaims,\n  parseQueryUrl,\n  request,\n  runIframe,\n  validateIdToken,\n} from \"./utils\"\nimport { cleanUndefined, mergeObjects } from \"./utils/object\"\n\nimport { isResponseType, isScopeIncluded } from \"./utils/oidc\"\nimport { runPopup } from \"./utils/popup\"\nimport { TabUtils } from \"./utils/tab_utils\"\n\n/**\n * `OIDCClient` provides methods for interacting with OIDC/OAuth2 authorization server. Those methods are signing a\n * user in, signing out, managing the user's claims, checking session and managing tokens returned from the\n * OIDC/OAuth2 provider.\n *\n */\nexport class OIDCClient extends EventEmitter<EventTypes> {\n  options: IPlusAuthClientOptions\n\n  user?: any\n\n  scopes?: string[]\n\n  accessToken?: string\n\n  refreshToken?: string\n\n  idToken?: string\n\n  idTokenRaw?: string\n\n  issuer_metadata?: Record<string, any>\n\n  private readonly http: (options: RequestOptions) => Promise<any> | never\n\n  private synchronizer: TabUtils\n\n  private stateStore: StateStore<StateRecord>\n\n  private authStore: StateStore<AuthRecord>\n\n  private sessionCheckerFrame?: SessionChecker\n\n  private _accessTokenExpireTimer?: Timer\n\n  private initialized!: boolean\n\n  private __initializePromise!: Promise<any> | undefined\n\n  constructor(options: IPlusAuthClientOptions) {\n    super()\n    if (!isValidIssuer(options.issuer)) {\n      throw new OIDCClientError('\"issuer\" must be a valid uri.')\n    }\n\n    this.synchronizer = new TabUtils(btoa(options.issuer), this)\n\n    this.options = mergeObjects(\n      {\n        secondsToRefreshAccessTokenBeforeExp: 60,\n        autoSilentRenew: true,\n        checkSession: true,\n        stateLength: 10,\n        nonceLength: 10,\n      },\n      options,\n      {\n        // remove last slash for consistency across the lib\n        issuer: options.issuer.endsWith(\"/\") ? options.issuer.slice(0, -1) : options.issuer,\n      },\n    )\n\n    this.http = this.options.httpClient || request\n    this.stateStore =\n      this.options.stateStore || new LocalStorageStateStore<StateRecord>(\"pa_oidc.state.\")\n    this.authStore = this.options.authStore || new InMemoryStateStore<AuthRecord>()\n\n    if (this.options.autoSilentRenew) {\n      this._accessTokenExpireTimer = new Timer()\n    }\n\n    this.on(Events.USER_LOGOUT, async () => {\n      this.user = undefined\n      this.scopes = undefined\n      this.accessToken = undefined\n      this.idToken = undefined\n      this.refreshToken = undefined\n      await this.authStore.clear()\n    })\n\n    this.synchronizer.OnBroadcastMessage(Events.USER_LOGIN, this.onUserLogin.bind(this))\n  }\n\n  /**\n   * Initialize the library with this method. It resolves issuer configuration, jwks keys which are necessary for\n   * validating tokens returned from provider and checking if a user is already authenticated in provider.\n   *\n   * @param checkLogin Make this `false` if you don't want to check user authorization status in provider while\n   * initializing. Defaults to `true`\n   */\n  async initialize(checkLogin = true): Promise<OIDCClient> | never {\n    if (this.initialized) {\n      return this\n    }\n\n    if (this.__initializePromise) {\n      return this.__initializePromise\n    }\n    this.__initializePromise = new Promise(async (resolve, reject) => {\n      try {\n        if (this.stateStore.init) {\n          await this.stateStore.init()\n        }\n        if (this.authStore.init) {\n          await this.authStore.init()\n        }\n\n        if (!this.options.endpoints || Object.keys(this.options.endpoints).length === 0) {\n          await this.fetchFromIssuer()\n        }\n        this.initialized = true\n\n        if (checkLogin) {\n          try {\n            if (!window?.frameElement) {\n              await this.silentLogin()\n            }\n          } catch (e) {\n            this.emit(Events.SILENT_RENEW_ERROR, e)\n            await this.authStore.clear()\n          }\n        } else {\n          const localAuth = await this.authStore.get(\"auth\")\n          if (localAuth) {\n            await this.onUserLogin(localAuth, true)\n          }\n        }\n        resolve(this)\n      } catch (e) {\n        if (e instanceof OIDCClientError) {\n          reject(e)\n        } else {\n          reject(new OIDCClientError(e.message))\n        }\n      } finally {\n        this.__initializePromise = undefined\n      }\n    })\n\n    return this.__initializePromise\n  }\n\n  /**\n   * Redirect to provider's authorization endpoint using provided parameters. You can override any parameter defined\n   * in `OIDCClient`. If you don't provide `state`, `nonce` or `code_verifier` they will be generated automatically\n   * in a random and secure way.\n   *\n   * @param options\n   * @param localState\n   */\n  async login(options: Partial<AuthRequestOptions> = {}, localState: Record<string, any> = {}) {\n    window.location.assign(await this.createAuthRequest(options, localState))\n  }\n\n  /**\n   * Open a popup with the provider's authorization endpoint using provided parameters. You can override any\n   * parameter defined in `OIDCClient`. If you don't provide `state`, `nonce` or `code_verifier` they will be\n   * generated automatically in a random and secure way. You can also override popup options.\n   *\n   * NOTE: Most browsers block popups if they are not happened as a result of user actions. In order to display\n   * login popup you must call this method in an event handler listening for a user action like button click.\n   *\n   * @param options\n   * @param popupOptions\n   */\n  async loginWithPopup(options: Partial<AuthRequestOptions> = {}, popupOptions: PopupOptions = {}) {\n    const url = await this.createAuthRequest({\n      response_mode: \"fragment\",\n      ...options,\n      display: \"popup\",\n      request_type: \"p\",\n    })\n    const { response, state } = await runPopup(url, popupOptions)\n    const { authParams, localState } =\n      !state || typeof state === \"string\" ? await this.loadState(state || response.state) : state\n    const tokenResult = await this.handleAuthResponse(response, authParams, localState)\n    const authObject = await this.handleTokenResult(\n      tokenResult,\n      authParams,\n      mergeObjects(this.options, authParams),\n    )\n    authObject.session_state = response.session_state\n    this.synchronizer.BroadcastMessageToAllTabs(Events.USER_LOGIN, authObject)\n    return localState\n  }\n\n  /**\n   * After a user successfully authorizes an application, the authorization server will redirect the user back to\n   * the application with either an authorization code or access token in the URL. In the callback page you should\n   * call this method.\n   *\n   * @param url Full url which contains authorization request result parameters. Defaults to `window.location.href`\n   */\n  async loginCallback(url: string = window?.location?.href) {\n    if (!url) {\n      return Promise.reject(new OIDCClientError(\"Url must be passed to handle login redirect\"))\n    }\n    let parsedUrl: URL\n    try {\n      parsedUrl = new URL(url)\n    } catch (e) {\n      return Promise.reject(new OIDCClientError(`Invalid callback url passed: \"${url}\"`))\n    }\n\n    const responseParams = parseQueryUrl(parsedUrl.search || parsedUrl.hash)\n    const rawStoredState = await this.loadState(responseParams.state)\n    const { authParams, localState, request_type } = rawStoredState\n    url = url || window.location.href\n    switch (request_type) {\n      case \"s\":\n        if (window?.frameElement) {\n          if (url) {\n            window.parent.postMessage(\n              {\n                type: \"authorization_response\",\n                response: responseParams,\n                state: rawStoredState,\n              },\n              `${location.protocol}//${location.host}`,\n            )\n          }\n        }\n        return\n      case \"p\":\n        if (window.opener && url) {\n          window.opener.postMessage(\n            {\n              type: \"authorization_response\",\n              response: responseParams,\n              state: rawStoredState,\n            },\n            `${location.protocol}//${location.host}`,\n          )\n        }\n        return\n      default: {\n        if (responseParams.error) {\n          return Promise.reject(\n            new AuthenticationError(responseParams.error, responseParams.error_description),\n          )\n        }\n        const tokenResult = await this.handleAuthResponse(responseParams, authParams, localState)\n        const authObject = await this.handleTokenResult(\n          tokenResult,\n          authParams,\n          mergeObjects(this.options, authParams),\n        )\n        authObject.session_state = responseParams.session_state\n        this.synchronizer.BroadcastMessageToAllTabs(Events.USER_LOGIN, authObject)\n        return localState\n      }\n    }\n  }\n\n  /**\n   * Redirect to provider's `end_session_endpoint` with provided parameters. After logout provider will redirect to\n   * provided `post_logout_redirect_uri` if it provided.\n   * @param options\n   */\n  async logout(options: LogoutRequestOptions = {}) {\n    if (!options.localOnly) {\n      const storedAuth = await this.authStore.get(\"auth\")\n      const id_token_hint = options.id_token_hint || storedAuth?.id_token_raw\n      window.location.assign(\n        await this.createLogoutRequest({\n          ...options,\n          id_token_hint,\n        }),\n      )\n    }\n    await this.authStore.clear()\n  }\n\n  /**\n   * OAuth2 token revocation implementation method. See more at [tools.ietf.org/html/rfc7009](https://tools.ietf.org/html/rfc7009)\n   * @param token Token to be revoked\n   * @param type Passed token's type. It will be used to provide `token_type_hint` parameter.\n   * @param options If necessary override options passed to `OIDCClient` by defining them here.\n   */\n  async revokeToken(token: string, type: TokenType = \"access_token\", options: RevokeOptions = {}) {\n    if (!this.options.endpoints!.revocation_endpoint) {\n      return Promise.reject(new OIDCClientError('\"revocation_endpoint\" doesn\\'t exist'))\n    }\n    const finalOptions = {\n      client_id: options.client_id || this.options.client_id,\n      client_secret: options.client_secret || this.options.client_secret,\n      token_type_hint: type,\n      token: token,\n    }\n\n    return this.http({\n      method: \"POST\",\n      requestType: \"form\",\n      url: this.options.endpoints!.revocation_endpoint,\n      body: finalOptions,\n    })\n  }\n\n  /**\n   * Login without having an interaction. If refresh tokens are used and there is a stored refresh token it will\n   * exchange refresh token to receive new access token. If not it silently makes a request the provider's\n   * authorization endpoint using provided parameters. You can override any parameter defined in `OIDCClient`. If\n   * you don't provide `state`, `nonce` or `code_verifier` they will be generated automatically in a random and\n   * secure way.\n   *\n   * @param options\n   * @param localState\n   */\n  async silentLogin(options: AuthRequestOptions = {}, localState: Record<string, any> = {}) {\n    await this.initialize(false)\n    let tokenResult: any\n    let finalState: any = {}\n\n    const storedAuth = (await this.authStore.get(\"auth\")) || {}\n\n    const finalOptions = mergeObjects(\n      {\n        response_mode: \"query\",\n        display: \"page\",\n        prompt: \"none\",\n      },\n      this.options,\n      options,\n    )\n\n    if (finalOptions.silent_redirect_uri) {\n      finalOptions.redirect_uri = finalOptions.silent_redirect_uri\n    }\n\n    if (this.options.useRefreshToken && storedAuth?.refresh_token) {\n      finalState.authParams = mergeObjects(\n        storedAuth?.authParams || {},\n        finalState.authParams || {},\n      )\n      tokenResult = await this.exchangeRefreshToken({\n        ...finalOptions,\n        refresh_token: storedAuth.refresh_token,\n      })\n    } else {\n      const authUrl = await this.createAuthRequest(\n        {\n          ...finalOptions,\n          request_type: \"s\",\n        },\n        localState,\n      )\n\n      const { response, state } = await runIframe(authUrl, {\n        timeout: finalOptions.silentRequestTimeout,\n        eventOrigin: window.location.origin,\n      })\n      tokenResult = await this.handleAuthResponse(response, finalOptions, localState)\n      storedAuth.session_state = response.session_state\n      finalState = state\n    }\n\n    const authObject = await this.handleTokenResult(\n      tokenResult,\n      finalState.authParams,\n      finalOptions,\n    )\n    authObject.session_state = storedAuth.session_state\n    this.synchronizer.BroadcastMessageToAllTabs(Events.USER_LOGIN, authObject)\n    return finalState.localState\n  }\n\n  /**\n   * Retrieve logged in user's access token if it exists.\n   */\n  async getAccessToken() {\n    return (await this.authStore.get(\"auth\"))?.access_token\n  }\n\n  /**\n   * Retrieve logged in user's refresh token if it exists.\n   */\n  async getRefreshToken() {\n    return (await this.authStore.get(\"auth\"))?.refresh_token\n  }\n\n  /**\n   * Retrieve logged in user's parsed id token if it exists.\n   */\n  async getIdToken() {\n    return (await this.authStore.get(\"auth\"))?.id_token\n  }\n\n  /**\n   * Retrieve access token's expiration.\n   */\n  async getExpiresIn() {\n    return (await this.authStore.get(\"auth\"))?.expires_in\n  }\n\n  /**\n   * Retrieve logged in user's id token in raw format if it exists.\n   */\n  async getIdTokenRaw() {\n    return (await this.authStore.get(\"auth\"))?.id_token_raw\n  }\n\n  /**\n   * Retrieve logged in user's scopes if it exists.\n   */\n  async getScopes() {\n    return (await this.authStore.get(\"auth\"))?.scope?.split(\" \")\n  }\n\n  /**\n   * Retrieve logged in user's profile.\n   */\n  async getUser() {\n    return (await this.authStore.get(\"auth\"))?.user\n  }\n\n  /**\n   * If there is a user stored locally return true. Otherwise it will make a silentLogin to check if End-User is\n   * logged in provider.\n   *\n   * @param localOnly Don't check provider\n   */\n  async isLoggedIn(localOnly = false) {\n    const existsOnLocal = !!(await this.getUser())\n    if (!existsOnLocal && !localOnly) {\n      try {\n        await this.silentLogin()\n        return true\n      } catch (e) {\n        return false\n      }\n    }\n    return existsOnLocal\n  }\n\n  /**\n   * Create authorization request with provided options.\n   *\n   * @param options\n   * @param localState\n   * @private\n   */\n  private async createAuthRequest(\n    options: Partial<AuthRequestOptions> = {},\n    localState: Record<string, any> = {},\n  ): Promise<string> {\n    if (!this.options.endpoints?.authorization_endpoint) {\n      await this.initialize(false)\n    }\n    // TODO: deep merge for extra params\n    const finalOptions = Object.assign({}, this.options, options)\n    localState.code_verifier = generateRandom(72)\n\n    const authParams = {\n      client_id: finalOptions.client_id,\n      state: generateRandom(finalOptions.stateLength!),\n      scope: finalOptions.scope,\n      audience: finalOptions.audience,\n      redirect_uri: finalOptions.redirect_uri,\n      response_mode: finalOptions.response_mode,\n      response_type: finalOptions.response_type || \"code\",\n      ui_locales: finalOptions.ui_locales,\n      prompt: finalOptions.prompt,\n      display: finalOptions.display,\n      claims: finalOptions.claims,\n      claims_locales: finalOptions.claims_locales,\n      acr_values: finalOptions.acr_values,\n      registration: finalOptions.registration,\n      login_hint: finalOptions.login_hint,\n      id_token_hint: finalOptions.id_token_hint,\n      web_message_uri: finalOptions.web_message_uri,\n      web_message_target: finalOptions.web_message_target,\n      ...(finalOptions.extraParams && finalOptions.extraParams),\n    } as AuthRequestOptions\n\n    if (\n      isResponseType(\"id_token\", authParams.response_type) ||\n      isScopeIncluded(\"openid\", authParams.scope)\n    ) {\n      authParams.nonce = generateRandom(finalOptions.nonceLength!)\n    }\n\n    if (isResponseType(\"code\", authParams.response_type)) {\n      authParams.code_challenge = await deriveChallenge(localState.code_verifier)\n      authParams.code_challenge_method = finalOptions.code_challenge_method || \"S256\"\n    }\n\n    const now = this.options.currentTimeInMillis?.() || Date.now()\n    const fragment = finalOptions.fragment ? `#${finalOptions.fragment}` : \"\"\n    const authParamsString = buildEncodedQueryString(authParams)\n    const url = `${this.options.endpoints!.authorization_endpoint}${authParamsString}${fragment}`\n\n    // clear 1 day old state entries\n    this.stateStore.clear(now - 86400000)\n\n    await this.stateStore.set(\n      authParams.state!,\n      cleanUndefined({\n        created_at: now,\n        authParams,\n        localState,\n        request_type: finalOptions.request_type,\n      }),\n    )\n    return url\n  }\n\n  /**\n   * Create a logout request with given options\n   *\n   * @param options\n   * @private\n   */\n  private async createLogoutRequest(options: LogoutRequestOptions = {}) {\n    if (!this.options.endpoints?.end_session_endpoint) {\n      await this.fetchFromIssuer()\n    }\n    const finalOptions = mergeObjects(this.options, options)\n    const logoutParams = {\n      id_token_hint: finalOptions.id_token_hint,\n      post_logout_redirect_uri: finalOptions.post_logout_redirect_uri,\n      ...(finalOptions.extraLogoutParams || {}),\n    }\n    return `${this.options.endpoints!.end_session_endpoint}${buildEncodedQueryString(logoutParams)}`\n  }\n\n  /**\n   * Exchange authorization code retrieved from auth request result.\n   * @param options\n   * @private\n   */\n  private async exchangeAuthorizationCode(options: TokenRequestOption) {\n    if (!this.options.endpoints?.token_endpoint) {\n      await this.fetchFromIssuer()\n    }\n    const finalOptions = mergeObjects(this.options, options)\n    const { extraTokenHeaders, extraTokenParams, ...rest } = finalOptions\n    const mergedOptions = {\n      ...rest,\n      ...(extraTokenParams || {}),\n      grant_type: \"authorization_code\",\n    }\n\n    for (const req of [\"code\", \"redirect_uri\", \"code_verifier\", \"client_id\"] as const) {\n      if (!mergedOptions[req]) {\n        return Promise.reject(new Error(`\"${req}\" is required`))\n      }\n    }\n\n    return this.http({\n      url: `${this.options.endpoints!.token_endpoint}`,\n      method: \"POST\",\n      requestType: \"form\",\n      body: mergedOptions as any,\n      headers: extraTokenHeaders,\n    })\n  }\n\n  /**\n   * Exchange refresh token with given options\n   * @param options\n   * @private\n   */\n  private async exchangeRefreshToken(options: Partial<TokenRequestOption>) {\n    if (!this.options.endpoints?.token_endpoint) {\n      await this.fetchFromIssuer()\n    }\n    const { extraTokenHeaders, extraTokenParams, ...rest } = options\n    const mergedOptions = {\n      grant_type: \"refresh_token\",\n      client_id: this.options.client_id,\n      client_secret: this.options.client_secret,\n      ...rest,\n      ...(extraTokenParams || {}),\n    }\n\n    for (const req of [\"refresh_token\", \"client_id\"] as const) {\n      if (!mergedOptions[req]) {\n        return Promise.reject(new Error(`\"${req}\" is required`))\n      }\n    }\n\n    return this.http({\n      url: `${this.options.endpoints!.token_endpoint}`,\n      method: \"POST\",\n      requestType: \"form\",\n      body: mergedOptions as any,\n      headers: extraTokenHeaders,\n    })\n  }\n\n  /**\n   * Fetch OIDC configuration from the issuer.\n   */\n  private async fetchFromIssuer(): Promise<Record<string, any>> {\n    try {\n      const requestUrl = `${this.options.issuer}/.well-known/openid-configuration`\n      const response = await this.http({\n        url: requestUrl,\n        method: \"GET\",\n        requestType: \"json\",\n      })\n      this.issuer_metadata = response as Record<string, any>\n      const endpoints = {} as any\n      for (const prop of Object.keys(this.issuer_metadata)) {\n        if (\n          prop.endsWith(\"_endpoint\") ||\n          prop.indexOf(\"_session\") > -1 ||\n          prop.indexOf(\"_uri\") > -1\n        ) {\n          endpoints[prop as keyof IEndpointConfiguration] = this.issuer_metadata[prop]\n        }\n      }\n      this.options.endpoints = endpoints\n      return this.issuer_metadata\n    } catch (e) {\n      throw new OIDCClientError(\"Loading metadata failed\", e.message)\n    }\n  }\n\n  /**\n   * Handle auth request result. If there is `code` exchange it.\n   * @param response\n   * @param finalOptions\n   * @param localState\n   * @private\n   */\n  private async handleAuthResponse(\n    response: any,\n    finalOptions: AuthRequestOptions,\n    localState: Record<string, any> = {},\n  ) {\n    if (response.code) {\n      return this.exchangeAuthorizationCode({\n        redirect_uri: finalOptions.redirect_uri,\n        client_id: finalOptions.client_id,\n        code_verifier: localState.code_verifier,\n        grant_type: \"authorization_code\",\n        code: response.code,\n      })\n    }\n    return response\n  }\n\n  /**\n   * Handle OAuth2 auth request result\n   * @param tokenResult\n   * @param authParams\n   * @param finalOptions\n   * @private\n   */\n  private async handleTokenResult(\n    tokenResult: TokenResponse,\n    authParams: AuthRequestOptions,\n    finalOptions: IPlusAuthClientOptions,\n  ) {\n    await this.initialize(false)\n    let user: any = {}\n    if (tokenResult.error) {\n      throw new AuthenticationError(tokenResult.error, tokenResult.error_description)\n    }\n    let parsedIDToken: any\n    if (tokenResult.id_token) {\n      parsedIDToken = await validateIdToken(tokenResult.id_token, authParams.nonce!, finalOptions)\n      if (\n        finalOptions.idTokenValidator &&\n        !(await finalOptions.idTokenValidator(tokenResult.id_token))\n      ) {\n        return Promise.reject(new InvalidIdTokenError(\"Id Token validation failed\"))\n      }\n      Object.keys(parsedIDToken).forEach((key) => {\n        if (!nonUserClaims.includes(key as any)) {\n          user[key] = parsedIDToken[key]\n        }\n      })\n    }\n\n    if (tokenResult.access_token) {\n      if (finalOptions.requestUserInfo && this.options.endpoints?.userinfo_endpoint) {\n        const userInfoResult = await this.fetchUserInfo(tokenResult.access_token)\n        if (!userInfoResult.error) {\n          user = { ...user, ...userInfoResult }\n        }\n      }\n    }\n\n    return {\n      authParams,\n      user,\n      ...tokenResult,\n      id_token: parsedIDToken,\n      id_token_raw: tokenResult.id_token,\n      scope: tokenResult.scope || authParams.scope,\n    }\n  }\n\n  /**\n   * Load stored state\n   *\n   * @param state\n   * @private\n   */\n  private async loadState(state: string) {\n    const rawStoredState = await this.stateStore.get(state)\n    if (!rawStoredState) {\n      return Promise.reject(new StateNotFound(\"Local state not found\", state))\n    }\n    await this.stateStore.del(state)\n    return rawStoredState\n  }\n\n  /**\n   * Load user info by making request to providers `userinfo_endpoint`\n   *\n   * @param accessToken\n   * @private\n   */\n  private async fetchUserInfo(accessToken: string) {\n    return this.http({\n      method: \"GET\",\n      url: `${this.options.endpoints!.userinfo_endpoint}`,\n      requestType: \"json\",\n      headers: {\n        Authorization: `Bearer ${accessToken}`,\n      },\n    })\n  }\n\n  /**\n   * Start monitoring End-User's session if the OIDC provider supports session management. See more at [OIDC Session\n   * Management](https://openid.net/specs/openid-connect-session-1_0.html)\n   *\n   * @param sub End-User's id to for monitoring session\n   * @param session_state string that represents the End-User's login state at the OP\n   */\n  private monitorSession({ sub, session_state }: SessionMonitorOptions) {\n    const { client_id, endpoints } = this.options\n\n    if (!endpoints?.check_session_iframe) {\n      console.warn(\n        '\"check_session_iframe\" endpoint missing or session management is not supported by provider',\n      )\n      return\n    }\n    if (!this.sessionCheckerFrame) {\n      const sessionCheckCallback = async (err: any) => {\n        if (err) {\n          this.emit(Events.USER_LOGOUT)\n        } else {\n          this.emit(Events.SESSION_CHANGE)\n          try {\n            await this.silentLogin({}, {})\n            const storedAuth = await this.authStore.get(\"auth\")\n            if (storedAuth) {\n              if (storedAuth.user?.sub === sub && storedAuth.session_state) {\n                this.sessionCheckerFrame!.start(storedAuth.session_state)\n              }\n            } else {\n              this.emit(Events.USER_LOGOUT, null)\n            }\n          } catch (e) {\n            this.emit(Events.USER_LOGOUT)\n            return\n          }\n        }\n      }\n\n      this.sessionCheckerFrame = createSessionCheckerFrame({\n        url: endpoints.check_session_iframe,\n        client_id: client_id,\n        callback: sessionCheckCallback,\n        checkInterval: this.options.checkSessionInterval,\n      })\n    }\n\n    this.sessionCheckerFrame.start(session_state)\n  }\n\n  private async onUserLogin(authObj: any, isInternal = false) {\n    const {\n      expires_in,\n      user,\n      scope,\n      access_token,\n      id_token,\n      refresh_token,\n      session_state,\n      id_token_raw,\n    } = authObj\n    await this.authStore.set(\"auth\", authObj)\n\n    this.user = user\n    this.scopes = scope?.split(\" \")\n    this.accessToken = access_token\n    this.idToken = id_token\n    this.idTokenRaw = id_token_raw\n    this.refreshToken = refresh_token\n\n    if (!isInternal) {\n      this.emit(Events.USER_LOGIN, authObj)\n    }\n    if (!window?.frameElement) {\n      if (this.options.checkSession) {\n        this.monitorSession({ sub: user.sub || user.id, session_state })\n      }\n\n      if (expires_in !== undefined && this.options.autoSilentRenew) {\n        const expiration = Number(expires_in) - this.options.secondsToRefreshAccessTokenBeforeExp!\n        const renew = () => {\n          this.synchronizer.CallOnce(\"silent-login\", async () => {\n            try {\n              await this.silentLogin()\n              this.emit(Events.SILENT_RENEW_SUCCESS, null)\n            } catch (e) {\n              this.emit(Events.SILENT_RENEW_ERROR, e)\n            }\n          })\n        }\n        if (expiration >= 0) {\n          this._accessTokenExpireTimer!.start(expiration, async () => {\n            renew()\n          })\n        } else {\n          renew()\n        }\n      }\n    }\n  }\n}\n","'use strict'\n\nexports.byteLength = byteLength\nexports.toByteArray = toByteArray\nexports.fromByteArray = fromByteArray\n\nvar lookup = []\nvar revLookup = []\nvar Arr = typeof Uint8Array !== 'undefined' ? Uint8Array : Array\n\nvar code = 'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/'\nfor (var i = 0, len = code.length; i < len; ++i) {\n  lookup[i] = code[i]\n  revLookup[code.charCodeAt(i)] = i\n}\n\n// Support decoding URL-safe base64 strings, as Node.js does.\n// See: https://en.wikipedia.org/wiki/Base64#URL_applications\nrevLookup['-'.charCodeAt(0)] = 62\nrevLookup['_'.charCodeAt(0)] = 63\n\nfunction getLens (b64) {\n  var len = b64.length\n\n  if (len % 4 > 0) {\n    throw new Error('Invalid string. Length must be a multiple of 4')\n  }\n\n  // Trim off extra bytes after placeholder bytes are found\n  // See: https://github.com/beatgammit/base64-js/issues/42\n  var validLen = b64.indexOf('=')\n  if (validLen === -1) validLen = len\n\n  var placeHoldersLen = validLen === len\n    ? 0\n    : 4 - (validLen % 4)\n\n  return [validLen, placeHoldersLen]\n}\n\n// base64 is 4/3 + up to two characters of the original data\nfunction byteLength (b64) {\n  var lens = getLens(b64)\n  var validLen = lens[0]\n  var placeHoldersLen = lens[1]\n  return ((validLen + placeHoldersLen) * 3 / 4) - placeHoldersLen\n}\n\nfunction _byteLength (b64, validLen, placeHoldersLen) {\n  return ((validLen + placeHoldersLen) * 3 / 4) - placeHoldersLen\n}\n\nfunction toByteArray (b64) {\n  var tmp\n  var lens = getLens(b64)\n  var validLen = lens[0]\n  var placeHoldersLen = lens[1]\n\n  var arr = new Arr(_byteLength(b64, validLen, placeHoldersLen))\n\n  var curByte = 0\n\n  // if there are placeholders, only get up to the last complete 4 chars\n  var len = placeHoldersLen > 0\n    ? validLen - 4\n    : validLen\n\n  var i\n  for (i = 0; i < len; i += 4) {\n    tmp =\n      (revLookup[b64.charCodeAt(i)] << 18) |\n      (revLookup[b64.charCodeAt(i + 1)] << 12) |\n      (revLookup[b64.charCodeAt(i + 2)] << 6) |\n      revLookup[b64.charCodeAt(i + 3)]\n    arr[curByte++] = (tmp >> 16) & 0xFF\n    arr[curByte++] = (tmp >> 8) & 0xFF\n    arr[curByte++] = tmp & 0xFF\n  }\n\n  if (placeHoldersLen === 2) {\n    tmp =\n      (revLookup[b64.charCodeAt(i)] << 2) |\n      (revLookup[b64.charCodeAt(i + 1)] >> 4)\n    arr[curByte++] = tmp & 0xFF\n  }\n\n  if (placeHoldersLen === 1) {\n    tmp =\n      (revLookup[b64.charCodeAt(i)] << 10) |\n      (revLookup[b64.charCodeAt(i + 1)] << 4) |\n      (revLookup[b64.charCodeAt(i + 2)] >> 2)\n    arr[curByte++] = (tmp >> 8) & 0xFF\n    arr[curByte++] = tmp & 0xFF\n  }\n\n  return arr\n}\n\nfunction tripletToBase64 (num) {\n  return lookup[num >> 18 & 0x3F] +\n    lookup[num >> 12 & 0x3F] +\n    lookup[num >> 6 & 0x3F] +\n    lookup[num & 0x3F]\n}\n\nfunction encodeChunk (uint8, start, end) {\n  var tmp\n  var output = []\n  for (var i = start; i < end; i += 3) {\n    tmp =\n      ((uint8[i] << 16) & 0xFF0000) +\n      ((uint8[i + 1] << 8) & 0xFF00) +\n      (uint8[i + 2] & 0xFF)\n    output.push(tripletToBase64(tmp))\n  }\n  return output.join('')\n}\n\nfunction fromByteArray (uint8) {\n  var tmp\n  var len = uint8.length\n  var extraBytes = len % 3 // if we have 1 byte left, pad 2 bytes\n  var parts = []\n  var maxChunkLength = 16383 // must be multiple of 3\n\n  // go through the array every three bytes, we'll deal with trailing stuff later\n  for (var i = 0, len2 = len - extraBytes; i < len2; i += maxChunkLength) {\n    parts.push(encodeChunk(uint8, i, (i + maxChunkLength) > len2 ? len2 : (i + maxChunkLength)))\n  }\n\n  // pad the end with zeros, but make sure to not forget the extra bytes\n  if (extraBytes === 1) {\n    tmp = uint8[len - 1]\n    parts.push(\n      lookup[tmp >> 2] +\n      lookup[(tmp << 4) & 0x3F] +\n      '=='\n    )\n  } else if (extraBytes === 2) {\n    tmp = (uint8[len - 2] << 8) + uint8[len - 1]\n    parts.push(\n      lookup[tmp >> 10] +\n      lookup[(tmp >> 4) & 0x3F] +\n      lookup[(tmp << 2) & 0x3F] +\n      '='\n    )\n  }\n\n  return parts.join('')\n}\n","import { fromByteArray } from \"base64-js\"\n\nexport function isValidIssuer(issuer: string) {\n  try {\n    const url = new URL(issuer)\n    if (![\"http:\", \"https:\"].includes(url.protocol)) {\n      return false\n    }\n    if (url.search !== \"\" || url.hash !== \"\") {\n      return false\n    }\n    return true\n  } catch (e) {\n    return false\n  }\n}\nexport function buildEncodedQueryString(obj?: Record<string, any>, appendable = true) {\n  if (!obj) return \"\"\n  const ret: string[] = []\n  for (const d in obj) {\n    if (obj.hasOwnProperty(d) && obj[d]) {\n      ret.push(\n        `${encodeURIComponent(d)}=${encodeURIComponent(\n          typeof obj[d] === \"object\" ? JSON.stringify(obj[d]) : obj[d]!,\n        )}`,\n      )\n    }\n  }\n  return `${appendable ? \"?\" : \"\"}${ret.join(\"&\")}`\n}\n\nexport function parseQueryUrl(value: string) {\n  const result: Record<string, string> = {}\n  value = value.trim().replace(/^(\\?|#|&)/, \"\")\n  const params = value.split(\"&\")\n  for (let i = 0; i < params.length; i += 1) {\n    const paramAndValue = params[i]\n    const parts = paramAndValue.split(\"=\")\n    const key = decodeURIComponent(parts.shift()!)\n    const value = parts.length > 0 ? parts.join(\"=\") : \"\"\n    result[key] = decodeURIComponent(value)\n  }\n  return result\n}\n\nexport function urlSafe(buffer: Uint8Array): string {\n  const encoded = fromByteArray(new Uint8Array(buffer))\n  return encoded.replace(/\\+/g, \"-\").replace(/\\//g, \"_\").replace(/=/g, \"\")\n}\n","import { buildEncodedQueryString } from \"./url\"\n\nexport interface RequestOptions {\n  body?: Record<string, string | number | null | undefined>\n  headers?: Record<string, string>\n  method: \"GET\" | \"POST\" | \"PATCH\" | \"TRACE\" | \"OPTIONS\" | \"HEAD\"\n  requestType?: \"form\" | \"json\"\n  url: string\n}\n\nexport function request(options: RequestOptions): Promise<any> {\n  let body: any = null\n  let headers = options.headers || {}\n  if (options.method === \"POST\") {\n    headers = {\n      \"Content-Type\":\n        options.requestType === \"form\"\n          ? \"application/x-www-form-urlencoded;charset=UTF-8\"\n          : \"application/json;charset=UTF-8\",\n      ...headers,\n    }\n  }\n  if (options.body) {\n    body =\n      options.requestType === \"form\"\n        ? buildEncodedQueryString(options.body, false)\n        : JSON.stringify(options.body)\n  }\n\n  return new Promise((resolve, reject) => {\n    fetch(options.url, {\n      method: options.method,\n      body: body,\n      headers,\n    })\n      .then((value: Response) => resolve(value.json()))\n      .catch(reject)\n  })\n}\n","import { InvalidIdTokenError, InvalidJWTError, OIDCClientError } from \"../errors\"\nimport type { IPlusAuthClientOptions, JWTValidationOptions, ParsedJWT } from \"../interfaces\"\n\nimport { urlSafe } from \"./url\"\n\nconst CHARSET = \"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789\"\n\nfunction getRandomBytes(n: number) {\n  // @ts-ignore\n  const crypto = self.crypto || self.msCrypto\n  const QUOTA = 65536\n  const a = new Uint8Array(n)\n  for (let i = 0; i < n; i += QUOTA) {\n    crypto.getRandomValues(a.subarray(i, i + Math.min(n - i, QUOTA)))\n  }\n  return a\n}\n\nexport function generateRandom(length: number) {\n  let out = \"\"\n  const charsLen = CHARSET.length\n  const maxByte = 256 - (256 % charsLen)\n  while (length > 0) {\n    const buf = getRandomBytes(Math.ceil((length * 256) / maxByte))\n    for (let i = 0; i < buf.length && length > 0; i++) {\n      const randomByte = buf[i]\n      if (randomByte < maxByte) {\n        out += CHARSET.charAt(randomByte % charsLen)\n        length--\n      }\n    }\n  }\n  return out\n}\n\nexport function deriveChallenge(code: string): Promise<string> {\n  if (code.length < 43 || code.length > 128) {\n    return Promise.reject(new OIDCClientError(`Invalid code length: ${code.length}`))\n  }\n\n  return new Promise((resolve, reject) => {\n    crypto.subtle.digest(\"SHA-256\", new TextEncoder().encode(code)).then(\n      (buffer) => {\n        return resolve(urlSafe(new Uint8Array(buffer)))\n      },\n      (error) => {\n        /* istanbul ignore next */\n        return reject(error)\n      },\n    )\n  })\n}\n// https://datatracker.ietf.org/doc/html/rfc4648#section-5\nexport const urlDecodeB64 = (input: string) =>\n  decodeURIComponent(\n    atob(input.replace(/_/g, \"/\").replace(/-/g, \"+\"))\n      .split(\"\")\n      .map((c) => {\n        return `%${`00${c.charCodeAt(0).toString(16)}`.slice(-2)}`\n      })\n      .join(\"\"),\n  )\n\nexport function parseJwt(jwt: string): ParsedJWT {\n  try {\n    const parts = jwt.split(\".\")\n    if (parts.length !== 3) {\n      throw new Error(\"Wrong JWT format\")\n    }\n    return {\n      header: JSON.parse(urlDecodeB64(parts[0])),\n      payload: JSON.parse(urlDecodeB64(parts[1])),\n    }\n  } catch (e) {\n    throw new InvalidJWTError(\"Failed to parse jwt\")\n  }\n}\n\nexport function validateIdToken(id_token: string, nonce: string, options: IPlusAuthClientOptions) {\n  if (!nonce) {\n    throw new OIDCClientError(\"No nonce on state\")\n  }\n\n  try {\n    const jwt = parseJwt(id_token)\n\n    if (nonce !== jwt.payload.nonce) {\n      throw new Error(`Invalid nonce in id_token: ${jwt.payload.nonce}`)\n    }\n\n    validateJwt(id_token, options, true)\n\n    // @ts-ignore\n    if (!jwt.payload[\"sub\"]) {\n      throw new Error(\"No Subject (sub) present in id_token\")\n    }\n\n    return jwt.payload\n  } catch (e) {\n    throw new InvalidIdTokenError(e.message)\n  }\n}\n\nexport function validateJwt(jwt: string, options: JWTValidationOptions, isIdToken = false) {\n  // eslint-disable-next-line prefer-const\n  let { clockSkew, currentTimeInMillis, issuer, audience, client_id } = options\n  if (!clockSkew) {\n    clockSkew = 0\n  }\n  const now = (currentTimeInMillis?.() || Date.now()) / 1000\n\n  const payload = parseJwt(jwt).payload\n\n  if (!payload.iss) {\n    throw new InvalidJWTError(\"Issuer (iss) was not provided\")\n  }\n  if (payload.iss !== issuer) {\n    throw new InvalidJWTError(`Invalid Issuer (iss) in token: ${payload.iss}`)\n  }\n\n  if (!payload.aud) {\n    throw new InvalidJWTError(\"Audience (aud) was not provided\")\n  }\n\n  // Audience must be equal to client_id in id_token\n  // https://openid.net/specs/openid-connect-core-1_0.html#IDToken\n  if (\n    Array.isArray(payload.aud)\n      ? payload.aud.indexOf(isIdToken ? client_id : audience || client_id) === -1\n      : payload.aud !== (isIdToken ? client_id : audience || client_id)\n  ) {\n    throw new InvalidJWTError(`Invalid Audience (aud) in token: ${payload.aud}`)\n  }\n\n  if (payload.azp && payload.azp !== client_id) {\n    throw new InvalidJWTError(`Invalid Authorized Party (azp) in token: ${payload.azp}`)\n  }\n\n  const lowerNow = Math.ceil(now + clockSkew)\n  const upperNow = Math.floor(now - clockSkew)\n\n  if (!payload.iat) {\n    throw new InvalidJWTError(\"Issued At (iat) was not provided\")\n  }\n\n  if (lowerNow < Number(payload.iat)) {\n    throw new InvalidJWTError(`Issued At (iat) is in the future: ${payload.iat}`)\n  }\n\n  if (payload.nbf && lowerNow < Number(payload.nbf)) {\n    throw new InvalidJWTError(`Not Before time (nbf) is in the future: ${payload.nbf}`)\n  }\n\n  if (!payload.exp) {\n    throw new InvalidJWTError(\"Expiration Time (exp) was not provided\")\n  }\n  if (Number(payload.exp) < upperNow) {\n    throw new InvalidJWTError(`Expiration Time (exp) is in the past: ${payload.exp}`)\n  }\n\n  return payload\n}\n\n// Retrieved from https://www.iana.org/assignments/jwt/jwt.xhtml\nexport const nonUserClaims = [\n  \"iss\",\n  // 'sub',\n  \"aud\",\n  \"exp\",\n  \"nbf\",\n  \"iat\",\n  \"jti\",\n  \"azp\",\n  \"nonce\",\n  \"auth_time\",\n  \"at_hash\",\n  \"c_hash\",\n  \"acr\",\n  \"amr\",\n  \"sub_jwk\",\n  \"cnf\",\n  \"sip_from_tag\",\n  \"sip_date\",\n  \"sip_callid\",\n  \"sip_cseq_num\",\n  \"sip_via_branch\",\n  \"orig\",\n  \"dest\",\n  \"mky\",\n  \"events\",\n  \"toe\",\n  \"txn\",\n  \"rph\",\n  \"sid\",\n  \"vot\",\n  \"vtm\",\n  \"attest\",\n  \"origid\",\n  \"act\",\n  \"scope\",\n  \"client_id\",\n  \"may_act\",\n  \"jcard\",\n  \"at_use_nbr\",\n] as const\n","type RequiredAndNotNull<T> = {\n  [P in keyof T]-?: Exclude<T[P], undefined>\n}\n\n/**\n * not suitable for every object but it is enough for this library\n * @param object\n */\nexport function cleanUndefined<T extends Record<string, any>>(object: T) {\n  if (!object || typeof object !== \"object\") {\n    return object\n  }\n  return JSON.parse(JSON.stringify(object)) as RequiredAndNotNull<T>\n}\n\nfunction merge(previousValue: any, currentValue: any) {\n  for (const p in currentValue) {\n    if (currentValue[p] !== undefined) {\n      if (typeof currentValue[p] === \"object\" && currentValue[p].constructor.name === \"Object\") {\n        previousValue[p] = merge(previousValue[p] || {}, currentValue[p])\n      } else {\n        previousValue[p] = currentValue[p]\n      }\n    }\n  }\n  return previousValue\n}\nexport function mergeObjects<T extends object, U>(obj1: T, obj2: U): RequiredAndNotNull<T & U>\nexport function mergeObjects<T extends object, U, K>(\n  obj1: T,\n  obj2: U,\n  obj3: K,\n): RequiredAndNotNull<T & U & K>\nexport function mergeObjects(...objects: any[]) {\n  return objects.reduce((previousValue, currentValue) => {\n    return merge(previousValue || {}, currentValue)\n  }, {}) as any\n}\n","export const isResponseType = (type: string, response_type?: string) =>\n  response_type && response_type.split(/\\s+/g).filter((rt) => rt === type).length > 0\n\nexport const isScopeIncluded = (scope: string, scopes?: string) =>\n  scopes && scopes.split(\" \").indexOf(scope) > -1\n","import { InteractionCancelled, OIDCClientError } from \"../errors\"\nimport type { PopupOptions } from \"../interfaces\"\n\nconst openPopup = (url: string, width = 400, height = 600) => {\n  const left = window.screenX + (window.innerWidth - width) / 2\n  const top = window.screenY + (window.innerHeight - height) / 2\n\n  return window.open(\n    url,\n    \"oidc-login-popup\",\n    `left=${left},top=${top},width=${width},height=${height},resizable,scrollbars=yes,status=1`,\n  )\n}\n\nexport function runPopup(url: string, options: PopupOptions) {\n  let popup = options.popup\n\n  if (popup) {\n    popup.location.href = url\n  } else {\n    popup = openPopup(url)\n  }\n\n  if (!popup) {\n    /* istanbul ignore next */\n    throw new Error(\"Could not open popup\")\n  }\n\n  let timeoutId: any\n  let closeId: any\n\n  return new Promise<{ response: any; state: string }>((resolve, reject) => {\n    function clearHandlers() {\n      clearInterval(closeId)\n      clearTimeout(timeoutId)\n      window.removeEventListener(\"message\", messageListener)\n    }\n\n    timeoutId = setTimeout(\n      () => {\n        clearHandlers()\n        reject(new OIDCClientError(\"Timed out\"))\n      },\n      options.timeout || 60 * 1000,\n    )\n\n    closeId = setInterval(() => {\n      if (popup!.closed) {\n        clearHandlers()\n        reject(new InteractionCancelled(\"user closed popup\"))\n      }\n    }, 300)\n\n    window.addEventListener(\"message\", messageListener)\n\n    function messageListener(e: MessageEvent) {\n      if (!e.data || e.data.type !== \"authorization_response\") return\n      clearHandlers()\n      popup!.close()\n      const data = e.data.response || e.data\n      data.error ? reject(new OIDCClientError(data.error, data.error_description)) : resolve(e.data)\n    }\n  })\n}\n","/*\nJitbit TabUtils - helper for multiple browser tabs. version 1.0\nhttps://github.com/jitbit/TabUtils\n- executing \"interlocked\" function call - only once per multiple tabs\n- broadcasting a message to all tabs (including the current one) with some message \"data\"\n- handling a broadcasted message\nMIT license: https://github.com/jitbit/TabUtils/blob/master/LICENSE\n*/\n\nimport type { EventEmitter } from \"../helpers\"\n\nconst currentTabId = `${performance.now()}:${(Math.random() * 1000000000) | 0}`\nconst handlers: Record<string, any> = {}\n\nexport class TabUtils {\n  keyPrefix: string\n\n  private events: EventEmitter<any>\n\n  constructor(kid: string, fallbackEvents: EventEmitter<any>) {\n    this.keyPrefix = kid\n    this.events = fallbackEvents\n  }\n\n  //runs code only once in multiple tabs\n  //the lock holds for 4 seconds (in case the function is async and returns right away, for example, an ajax call intiated)\n  //then it is cleared\n  CallOnce(lockname: string, fn: () => void, timeout = 3000): void {\n    if (!lockname) throw \"empty lockname\"\n\n    if (!window.localStorage) {\n      //no local storage. old browser. screw it, just run the function\n      fn()\n      return\n    }\n\n    const localStorageKey = this.keyPrefix + lockname\n\n    localStorage.setItem(localStorageKey, currentTabId)\n    //re-read after a delay (after all tabs have saved their tabIDs into ls)\n    setTimeout(() => {\n      if (localStorage.getItem(localStorageKey) === currentTabId) fn()\n    }, 150)\n\n    //cleanup - release the lock after 3 seconds and on window unload (just in case user closed the window while the lock is still held)\n    setTimeout(() => {\n      localStorage.removeItem(localStorageKey)\n    }, timeout)\n  }\n\n  BroadcastMessageToAllTabs(messageId: string, eventData: any): void {\n    //now we also need to manually execute handler in the current tab too, because current tab does not get 'storage' events\n    try {\n      handlers[messageId](eventData)\n    } catch (x) {\n      //\"try\" in case handler not found\n    }\n\n    if (!window.localStorage) {\n      this.events.emit(messageId, eventData)\n      return //no local storage. old browser\n    }\n\n    const data = {\n      data: eventData,\n      timeStamp: new Date().getTime(),\n    } //add timestamp because overwriting same data does not trigger the event\n\n    //this triggers 'storage' event for all other tabs except the current tab\n    localStorage.setItem(`${this.keyPrefix}event${messageId}`, JSON.stringify(data))\n\n    //cleanup\n    setTimeout(() => {\n      localStorage.removeItem(`${this.keyPrefix}event${messageId}`)\n    }, 3000)\n  }\n\n  OnBroadcastMessage(messageId: string, fn: (data: any) => void): void {\n    handlers[messageId] = fn\n    if (!window.localStorage) {\n      this.events.on(messageId, fn)\n      return //no local storage. old browser\n    }\n\n    //first register a handler for \"storage\" event that we trigger above\n    window.addEventListener(\"storage\", (ev) => {\n      if (ev.key !== `${this.keyPrefix}event${messageId}`) return // ignore other keys\n      if (!ev.newValue) return //called by cleanup?\n      const messageData = JSON.parse(ev.newValue)\n      fn(messageData.data)\n    })\n  }\n}\n","import type { SessionChecker, SessionCheckerOptions } from \"../interfaces\"\n\nimport { createHiddenFrame } from \"./iframe\"\n\nconst DEFAULT_CHECK_INTERVAL = 2000\n\nexport function createSessionCheckerFrame(options: SessionCheckerOptions): SessionChecker {\n  const { url, callback, client_id, checkInterval } = options\n  let internalSessionState: string | null\n  const idx = url.indexOf(\"/\", url.indexOf(\"//\") + 2)\n  const frameOrigin = url.substr(0, idx)\n\n  const frame = createHiddenFrame()\n\n  let timer: any\n\n  const load = () => {\n    return new Promise((resolve) => {\n      window.document.body.appendChild(frame)\n      window.addEventListener(\"message\", iframeEventHandler, false)\n      frame.onload = () => {\n        resolve(null)\n      }\n    })\n  }\n\n  const start = (sessionState: string) => {\n    load().then(() => {\n      if (sessionState && internalSessionState !== sessionState) {\n        stop()\n        internalSessionState = sessionState\n        const send = () => {\n          frame.contentWindow!.postMessage(`${client_id} ${internalSessionState}`, frameOrigin)\n        }\n        send()\n        timer = window.setInterval(send, checkInterval || DEFAULT_CHECK_INTERVAL)\n      }\n    })\n  }\n\n  const stop = () => {\n    internalSessionState = null\n    if (timer) {\n      window.clearInterval(timer)\n      timer = null\n    }\n  }\n\n  const iframeEventHandler = (e: MessageEvent) => {\n    if (e.origin === frameOrigin && e.source === frame.contentWindow) {\n      if (e.data === \"error\") {\n        stop()\n        callback(e.data)\n      } else if (e.data === \"changed\") {\n        stop()\n        callback()\n      }\n    }\n  }\n\n  frame.setAttribute(\"src\", url)\n\n  return {\n    stop,\n    start,\n  }\n}\n","import { OIDCClient } from \"./client\"\nimport type { IPlusAuthClientOptions } from \"./interfaces\"\n\nexport * from \"./interfaces\"\nexport * from \"./client\"\nexport * from \"./constants\"\nexport * from \"./helpers\"\nexport * from \"./errors\"\n\n/**\n * Create OIDC client with initializing it. It resolves issuer metadata, jwks keys and check if user is\n * authenticated in OpenId Connect provider.\n */\nexport default function createOIDCClient(options: IPlusAuthClientOptions): Promise<OIDCClient> {\n  return new OIDCClient(options).initialize()\n}\n"],"names":["Events","USER_LOGOUT","USER_LOGIN","SILENT_RENEW_SUCCESS","SILENT_RENEW_ERROR","SESSION_CHANGE","OIDCClientError","Error","constructor","error","error_description","name","AuthenticationError","state","error_uri","StateNotFound","InvalidJWTError","details","InvalidIdTokenError","InteractionCancelled","StateStore","prefix","LocalStorageStateStore","get","key","Promise","resolve","value","window","localStorage","getItem","JSON","parse","set","setItem","stringify","del","removeItem","clear","before","i","storedKeys","length","substring","push","storedItem","created_at","e","InMemoryStateStore","map","forEach","val","ind","delete","Map","EventEmitter","once","event","fn","on","onArgs","off","apply","cb","callbacks","splice","emit","args","cbs","slice","len","Timer","start","duration","callback","expiration","now","_expiration","_timerHandle","stop","timerDuration","setInterval","clearInterval","currentTimeInMillisFunc","Date","_define_property","undefined","createHiddenFrame","iframe","document","createElement","style","width","height","position","visibility","display","title","ariaHidden","base64Js","byteLength","b64","lens","getLens","validLen","placeHoldersLen","toByteArray","tmp","arr","Arr","curByte","revLookup","charCodeAt","fromByteArray","uint8","extraBytes","parts","len2","encodeChunk","end","output","lookup","num","join","Uint8Array","Array","code","indexOf","buildEncodedQueryString","obj","appendable","ret","d","hasOwnProperty","encodeURIComponent","request","options","body","headers","method","requestType","reject","fetch","url","then","json","catch","CHARSET","generateRandom","out","charsLen","maxByte","buf","getRandomBytes","n","crypto","self","msCrypto","a","getRandomValues","subarray","Math","min","ceil","randomByte","charAt","urlDecodeB64","input","decodeURIComponent","atob","replace","split","c","toString","parseJwt","jwt","header","payload","nonUserClaims","mergeObjects","objects","reduce","previousValue","currentValue","merge","p","isResponseType","type","response_type","filter","rt","isScopeIncluded","scope","scopes","openPopup","left","screenX","innerWidth","top","screenY","innerHeight","open","currentTabId","performance","random","handlers","TabUtils","CallOnce","lockname","timeout","localStorageKey","keyPrefix","setTimeout","BroadcastMessageToAllTabs","messageId","eventData","x","events","data","timeStamp","getTime","OnBroadcastMessage","addEventListener","ev","newValue","messageData","kid","fallbackEvents","OIDCClient","initialize","checkLogin","initialized","__initializePromise","stateStore","init","authStore","endpoints","Object","keys","fetchFromIssuer","frameElement","silentLogin","localAuth","onUserLogin","message","login","localState","location","assign","createAuthRequest","loginWithPopup","popupOptions","response_mode","request_type","response","runPopup","timeoutId","closeId","popup","href","clearHandlers","clearTimeout","removeEventListener","messageListener","close","closed","authParams","loadState","tokenResult","handleAuthResponse","authObject","handleTokenResult","session_state","synchronizer","loginCallback","parsedUrl","URL","responseParams","parseQueryUrl","result","params","trim","paramAndValue","shift","search","hash","rawStoredState","parent","postMessage","protocol","host","opener","logout","localOnly","storedAuth","id_token_hint","id_token_raw","createLogoutRequest","revokeToken","token","revocation_endpoint","finalOptions","client_id","client_secret","token_type_hint","http","finalState","prompt","silent_redirect_uri","redirect_uri","useRefreshToken","refresh_token","exchangeRefreshToken","authUrl","silentRequestTimeout","eventOrigin","origin","onLoadTimeoutId","timeoutSetTimeoutId","removeIframe","iframeEventHandler","eventSource","source","resp","contains","removeChild","onLoadTimeout","appendChild","setAttribute","onload","getAccessToken","_this","access_token","getRefreshToken","getIdToken","id_token","getExpiresIn","expires_in","getIdTokenRaw","getScopes","_scope","getUser","user","isLoggedIn","existsOnLocal","_this_options_endpoints","_this_options_currentTimeInMillis","_this_options","authorization_endpoint","code_verifier","stateLength","audience","ui_locales","claims","claims_locales","acr_values","registration","login_hint","web_message_uri","web_message_target","extraParams","nonce","nonceLength","code_challenge","subtle","digest","TextEncoder","encode","buffer","encoded","code_challenge_method","currentTimeInMillis","call","fragment","authParamsString","end_session_endpoint","logoutParams","post_logout_redirect_uri","extraLogoutParams","exchangeAuthorizationCode","token_endpoint","extraTokenHeaders","extraTokenParams","rest","mergedOptions","grant_type","req","requestUrl","issuer","issuer_metadata","prop","endsWith","parsedIDToken","validateIdToken","validateJwt","isIdToken","clockSkew","iss","aud","isArray","azp","lowerNow","upperNow","floor","iat","Number","nbf","exp","idTokenValidator","includes","requestUserInfo","userinfo_endpoint","userInfoResult","fetchUserInfo","accessToken","Authorization","monitorSession","sub","check_session_iframe","console","warn","sessionCheckerFrame","sessionCheckCallback","err","createSessionCheckerFrame","internalSessionState","timer","checkInterval","idx","frameOrigin","substr","frame","load","contentWindow","sessionState","send","checkSessionInterval","authObj","isInternal","idToken","idTokenRaw","refreshToken","checkSession","id","autoSilentRenew","secondsToRefreshAccessTokenBeforeExp","renew","_accessTokenExpireTimer","isValidIssuer","btoa","httpClient","bind"],"mappings":"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","x_google_ignoreList":[9]}